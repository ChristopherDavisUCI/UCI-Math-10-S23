
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predict Diabetes &#8212; UC Irvine Math 10, Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Salary Classification By Using Decision Tree" href="KevinXu.html" />
    <link rel="prev" title="The analysis of relations between the total covid-affected population and other datas" href="HaoyangWang.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/digitsyellow.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UC Irvine Math 10, Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    UC Irvine, Math 10, Fall 2022
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week0/Week0-Intro.html">
   Week 0
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week0/Worksheet0.html">
     Worksheet 0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week0/Week0-Friday.html">
     Week 0 Friday
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week1/Week1-Intro.html">
   Week 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Monday.html">
     Week 1 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Worksheet1.html">
     Worksheet 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Tuesday.html">
     Week 1 Tuesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Wednesday.html">
     Week 1 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Worksheet2.html">
     Worksheet 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Videos.html">
     Week 1 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week1/Week1-Friday.html">
     Week 1 Friday
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week2/Week2-Intro.html">
   Week 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Monday.html">
     Week 2 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Wednesday.html">
     Week 2 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Friday.html">
     Week 2 Friday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Worksheet3.html">
     Worksheet 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Worksheet4.html">
     Worksheet 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week2/Week2-Videos.html">
     Week 2 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week3/Week3-Intro.html">
   Week 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Monday.html">
     Week 3 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Wednesday.html">
     Week 3 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Friday.html">
     Week 3 Friday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Worksheet5.html">
     Worksheet 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Worksheet6.html">
     Worksheet 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week3/Week3-Videos.html">
     Week 3 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week4/Week4-Intro.html">
   Week 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Monday.html">
     Week 4 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Wednesday.html">
     Week 4 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Friday.html">
     Week 4 Friday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Worksheet7.html">
     Worksheet 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Worksheet8.html">
     Worksheet 8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week4/Week4-Videos.html">
     Week 4 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week5/Week5-Intro.html">
   Week 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Monday.html">
     Week 5 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week5/Week5-Friday.html">
     Week 5 Friday
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week6/Week6-Intro.html">
   Week 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Monday.html">
     Week 6 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Wednesday.html">
     Week 6 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Friday.html">
     Week 6 Friday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Worksheet9.html">
     Worksheet 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Worksheet10.html">
     Worksheet 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week6/Week6-Videos.html">
     Week 6 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week7/Week7-Intro.html">
   Week 7
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Monday.html">
     Week 7 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Wednesday.html">
     Week 7 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Worksheet11.html">
     Worksheet 11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Worksheet12.html">
     Worksheet 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week7/Week7-Videos.html">
     Week 7 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week8/Week8-Intro.html">
   Week 8
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Videos.html">
     Week 8 Videos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Monday.html">
     Week 8 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Wednesday.html">
     Week 8 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Week8-Friday.html">
     Week 8 Friday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Worksheet13.html">
     Worksheet 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week8/Worksheet14.html">
     Worksheet 14
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week9/Week9-Intro.html">
   Week 9
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Monday.html">
     Week 9 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Wednesday.html">
     Week 9 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Worksheet15.html">
     Worksheet 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Worksheet16.html">
     Worksheet 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week9/Week9-Videos.html">
     Week 9 Videos
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Week10/Week10-Intro.html">
   Week 10
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week10/Week10-Monday.html">
     Week 10 Monday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week10/Week10-Wednesday.html">
     Week 10 Wednesday
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Week10/Week10-Friday.html">
     Week 10 Friday
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Proj-Intro.html">
   Course Project
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../CourseProject.html">
     Course Project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ExtraTopics.html">
     Possible extra topics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../StudentProjects.html">
   Student Projects
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="MariaAvalos.html">
     Analyzing and Visualizing Top Soccer Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NicholasBogarin.html">
     Hollywood Movie Gross Income
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MingyuChen.html">
     Attempts about finding aspects that can influence the effects of Music Therapy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NuoChen.html">
     Predict the Chance of admission to Graduate School
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="YuanGao.html">
     Major League Baseball (MLB) Team Performances Predictions &amp; Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="RyanHarner.html">
     Predicting Australian Cities With Weather
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AnerHuang.html">
     Customer Personality Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DerekJiang.html">
     Replace this with your project title
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="EricJones.html">
     Chip from Specs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="EdenKim.html">
     Global Life Expectancy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AryaKondur.html">
     NBA Shot Prediction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MichelleKwan.html">
     Analysis on Starbucks &amp; McDonald’s Menu Items
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SaraGraceLien.html">
     Applying Machine Learning techniques to the Fashion MNIST data set
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DanielLim.html">
     Spotify Popular Songs Correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NatalieMartinez.html">
     New York City Taxi Rides
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="AdityaKrishnanRadhakrishnan.html">
     Video Game Sales
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CeceSun.html">
     What contributes to a movie’s commercial success?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="KexinSun.html">
     Car Price Prediction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="NanakoTatewaki.html">
     Prediction of Canadian Car Accident
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="LeanderVonSchoenfeld.html">
     Key Financial Metrics Analysis of S&amp;P 500 Stocks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="EmilyWang.html">
     Predicting Heart Disease
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HaoyangWang.html">
     The analysis of relations between the total covid-affected population and other datas
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Predict Diabetes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="KevinXu.html">
     Salary Classification By Using Decision Tree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MingyanXu.html">
     The relationship and prediction between Pokemon’s stats and generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ShengkaiYang.html">
     NFL offense performance and analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HuangxiaoZhang.html">
     Netflix Stock Price
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="YihaoZhang.html">
     Title
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ChristopherDavisUCI/UCI-Math-10-F22/main?urlpath=tree/Proj/StudentProjects/YifengXiong.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/ChristopherDavisUCI/UCI-Math-10-F22"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/Proj/StudentProjects/YifengXiong.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-state-selection">
   Random state selection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-0-import-libraries">
   Part 0: Import Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-load-and-preprocess-data">
   Part 1: Load and Preprocess Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-decision-tree">
   Part 2: Decision Tree
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-random-forest">
   Part 2: Random Forest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-3-kmeans">
   Part 3: Kmeans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-4-kmeans-with-pca">
   Part 4: Kmeans with PCA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-5-logistic-regression">
   Part 5: Logistic Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-6-neural-network">
   Part 6: Neural Network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-7-ensemble-model">
   Part 7: Ensemble Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submission">
   Submission
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Predict Diabetes</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-state-selection">
   Random state selection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-0-import-libraries">
   Part 0: Import Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-load-and-preprocess-data">
   Part 1: Load and Preprocess Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-decision-tree">
   Part 2: Decision Tree
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-random-forest">
   Part 2: Random Forest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-3-kmeans">
   Part 3: Kmeans
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-4-kmeans-with-pca">
   Part 4: Kmeans with PCA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-5-logistic-regression">
   Part 5: Logistic Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-6-neural-network">
   Part 6: Neural Network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-7-ensemble-model">
   Part 7: Ensemble Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submission">
   Submission
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="predict-diabetes">
<h1>Predict Diabetes<a class="headerlink" href="#predict-diabetes" title="Permalink to this headline">#</a></h1>
<p>Author: Yifeng Xiong</p>
<p>Course Project, UC Irvine, Math 10, F22</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Diabetes is one of the more common diseases nowadays. We hope to use machine learning to build some efficient and accurate models to assist doctors in diagnosing the disease. In this dataset, all patients here are females at least 21 years old of Pima Indian heritage. There are 8 features:</p>
<ul class="simple">
<li><p>Pregnancies</p></li>
<li><p>Glucose</p></li>
<li><p>BloodPressure</p></li>
<li><p>SkinThickness</p></li>
<li><p>Insulin</p></li>
<li><p>BMI</p></li>
<li><p>DiabetesPedigreeFunction</p></li>
<li><p>Age</p></li>
</ul>
</section>
<section id="random-state-selection">
<h2>Random state selection<a class="headerlink" href="#random-state-selection" title="Permalink to this headline">#</a></h2>
<p>Random state in this notebook is set to 42. Because 42 is the answer to the Ultimate Question of Life, the Universe, and Everything. (The Hitchhiker’s Guide to the Galaxy by Douglas Adams)</p>
</section>
<section id="part-0-import-libraries">
<h2>Part 0: Import Libraries<a class="headerlink" href="#part-0-import-libraries" title="Permalink to this headline">#</a></h2>
<p>Libraries and functions that covered in Math 10:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">plot_tree</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">log_loss</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Libraries and functions for extra topics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/shared-libs/python3.10/py/lib/python3.10/site-packages/tqdm/auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-1-load-and-preprocess-data">
<h2>Part 1: Load and Preprocess Data<a class="headerlink" href="#part-1-load-and-preprocess-data" title="Permalink to this headline">#</a></h2>
<p>In this section, I will load the data using pandas, take a brief view of the data, and create train and test dataset.</p>
<p>Firstly, let’s load the dataset and take a look at the first five rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;diabetes.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
      <th>Outcome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dataset has 9 features in total, and the last feature is the one we want to predict. Class 1 means “tested positive for diabetes.”</p>
<p>Let’s take a look at the shape of the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(768, 9)
</pre></div>
</div>
</div>
</div>
<p>It’s also important to check whether there is nan in each column. And based on the result below, we do not need to drop any rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pregnancies                 False
Glucose                     False
BloodPressure               False
SkinThickness               False
Insulin                     False
BMI                         False
DiabetesPedigreeFunction    False
Age                         False
Outcome                     False
dtype: bool
</pre></div>
</div>
</div>
</div>
<p><strong>Extra 1</strong> (code from Hands-on Machine Learning with Scikit-Learn, Keras &amp; TensorFlow page 49)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/YifengXiong_19_0.png" src="../../_images/YifengXiong_19_0.png" />
</div>
</div>
<p>Based on the figure, we can see each feature has different range. I will use StandardScaler if needed.</p>
<p>It is important to split the training data and test data early. So that we will use no information from test data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;Outcome&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Outcome&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Some models may need scaled data, so let’s do it now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_train_scaled</span><span class="p">[</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also need to scale the test data.
However, we should <strong>not</strong> create a new StandardScaler but just use the one from training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_test_scaled</span><span class="p">[</span><span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Extra 2</strong>
Another way to take a brief look of the dataset. Based on the result, we can say now all features in X_train_scaled are much closer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pregnancies</th>
      <th>Glucose</th>
      <th>BloodPressure</th>
      <th>SkinThickness</th>
      <th>Insulin</th>
      <th>BMI</th>
      <th>DiabetesPedigreeFunction</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
      <td>6.140000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.735854e-17</td>
      <td>-2.169817e-17</td>
      <td>6.943414e-17</td>
      <td>1.041512e-16</td>
      <td>-2.603780e-17</td>
      <td>-5.699386e-16</td>
      <td>1.562268e-16</td>
      <td>-3.761016e-17</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
      <td>1.000815e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.130523e+00</td>
      <td>-3.775663e+00</td>
      <td>-3.752683e+00</td>
      <td>-1.322774e+00</td>
      <td>-7.012055e-01</td>
      <td>-4.135256e+00</td>
      <td>-1.162210e+00</td>
      <td>-1.035940e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-8.284601e-01</td>
      <td>-6.515379e-01</td>
      <td>-2.927587e-01</td>
      <td>-1.322774e+00</td>
      <td>-7.012055e-01</td>
      <td>-6.313921e-01</td>
      <td>-6.764304e-01</td>
      <td>-7.749361e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-2.243336e-01</td>
      <td>-1.204366e-01</td>
      <td>1.397318e-01</td>
      <td>1.686602e-01</td>
      <td>-3.352683e-01</td>
      <td>2.147879e-03</td>
      <td>-2.872124e-01</td>
      <td>-3.399290e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.818561e-01</td>
      <td>5.668710e-01</td>
      <td>5.722222e-01</td>
      <td>7.522648e-01</td>
      <td>4.159792e-01</td>
      <td>5.678085e-01</td>
      <td>4.295726e-01</td>
      <td>6.170866e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.004552e+00</td>
      <td>2.441346e+00</td>
      <td>2.842797e+00</td>
      <td>2.762458e+00</td>
      <td>6.583098e+00</td>
      <td>4.540363e+00</td>
      <td>5.796175e+00</td>
      <td>4.184145e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="part-2-decision-tree">
<h2>Part 2: Decision Tree<a class="headerlink" href="#part-2-decision-tree" title="Permalink to this headline">#</a></h2>
<p>The reason I use Decision Tree at first is that I want to find several important features in the dataset.</p>
<p>Firstly, let’s initiate a Deicison Tree with no limit, no limit means the Decision Tree can go as deep as it want.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_DT_no_limit</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_DT_no_limit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
<span class="n">clf_DT_no_limit</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Based on the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier.score">explanation</a> of function score, we can say the Decision Tree above get 100% accuracy on training data. It is not surprised since there is no limit on this model, so it can have very large depth and number of leaves. Let’s test it on the test dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_DT_no_limit</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7467532467532467
</pre></div>
</div>
</div>
</div>
<p>Obviously, this Decision Tree overfits the training data.</p>
<p>Then let’s add some limit on the Decision Tree. We test max_leaf_nodes from 2 to 40 and draw the training and testing loss curve together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT_train_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">DT_test_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">_clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_leaf_nodes</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
    <span class="n">train_error</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">),</span> <span class="n">_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
    <span class="n">DT_train_dict</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_error</span>
    <span class="n">test_error</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">),</span> <span class="n">_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
    <span class="n">DT_test_dict</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_error</span>
<span class="n">train_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">DT_train_dict</span><span class="p">)</span>
<span class="n">test_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">DT_test_dict</span><span class="p">)</span>
<span class="n">train_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
<span class="n">test_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">df_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_ser</span><span class="p">,</span> <span class="n">test_ser</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_loss</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_loss</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_melted</span> <span class="o">=</span> <span class="n">df_loss</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">c_DT</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Loss&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span>
<span class="p">)</span>
<span class="n">c_DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-b313c2f24e2b459a857d6cd930051b06"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b313c2f24e2b459a857d6cd930051b06") {
      outputDiv = document.getElementById("altair-viz-b313c2f24e2b459a857d6cd930051b06");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-0d9265e724fb75935957eca9c04e8d3f"}, "mark": "line", "encoding": {"color": {"field": "Type", "type": "nominal"}, "x": {"field": "max_leaf_nodes", "type": "quantitative"}, "y": {"field": "Loss", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-0d9265e724fb75935957eca9c04e8d3f": [{"max_leaf_nodes": 2, "Type": "train", "Loss": 0.5569860248785248}, {"max_leaf_nodes": 3, "Type": "train", "Loss": 0.5313186041835257}, {"max_leaf_nodes": 4, "Type": "train", "Loss": 0.49370636968084897}, {"max_leaf_nodes": 5, "Type": "train", "Loss": 0.47321705031427164}, {"max_leaf_nodes": 6, "Type": "train", "Loss": 0.45969557188187055}, {"max_leaf_nodes": 7, "Type": "train", "Loss": 0.44650790211346936}, {"max_leaf_nodes": 8, "Type": "train", "Loss": 0.43643834632684236}, {"max_leaf_nodes": 9, "Type": "train", "Loss": 0.4290428271270009}, {"max_leaf_nodes": 10, "Type": "train", "Loss": 0.42202930032837294}, {"max_leaf_nodes": 11, "Type": "train", "Loss": 0.41068539332938336}, {"max_leaf_nodes": 12, "Type": "train", "Loss": 0.403814097237769}, {"max_leaf_nodes": 13, "Type": "train", "Loss": 0.39279315846059637}, {"max_leaf_nodes": 14, "Type": "train", "Loss": 0.382404712063433}, {"max_leaf_nodes": 15, "Type": "train", "Loss": 0.37484259286787586}, {"max_leaf_nodes": 16, "Type": "train", "Loss": 0.3574460958198201}, {"max_leaf_nodes": 17, "Type": "train", "Loss": 0.3513971654101233}, {"max_leaf_nodes": 18, "Type": "train", "Loss": 0.34588277302338316}, {"max_leaf_nodes": 19, "Type": "train", "Loss": 0.3381144606955513}, {"max_leaf_nodes": 20, "Type": "train", "Loss": 0.3333330625975844}, {"max_leaf_nodes": 21, "Type": "train", "Loss": 0.32889064243393834}, {"max_leaf_nodes": 22, "Type": "train", "Loss": 0.32397297126127084}, {"max_leaf_nodes": 23, "Type": "train", "Loss": 0.3194493672772505}, {"max_leaf_nodes": 24, "Type": "train", "Loss": 0.31500694711360444}, {"max_leaf_nodes": 25, "Type": "train", "Loss": 0.31137536002364513}, {"max_leaf_nodes": 26, "Type": "train", "Loss": 0.30481647346956964}, {"max_leaf_nodes": 27, "Type": "train", "Loss": 0.298596465310337}, {"max_leaf_nodes": 28, "Type": "train", "Loss": 0.29483637349437786}, {"max_leaf_nodes": 29, "Type": "train", "Loss": 0.2874886400928215}, {"max_leaf_nodes": 30, "Type": "train", "Loss": 0.28254855764995684}, {"max_leaf_nodes": 31, "Type": "train", "Loss": 0.2793372864551636}, {"max_leaf_nodes": 32, "Type": "train", "Loss": 0.27201044418}, {"max_leaf_nodes": 33, "Type": "train", "Loss": 0.2678681719229957}, {"max_leaf_nodes": 34, "Type": "train", "Loss": 0.2624105219704849}, {"max_leaf_nodes": 35, "Type": "train", "Loss": 0.25804298382623225}, {"max_leaf_nodes": 36, "Type": "train", "Loss": 0.25149522206546343}, {"max_leaf_nodes": 37, "Type": "train", "Loss": 0.24742028376303515}, {"max_leaf_nodes": 38, "Type": "train", "Loss": 0.24334534546060696}, {"max_leaf_nodes": 39, "Type": "train", "Loss": 0.24023534138099062}, {"max_leaf_nodes": 2, "Type": "test", "Loss": 0.5527618465588776}, {"max_leaf_nodes": 3, "Type": "test", "Loss": 0.5290574547788799}, {"max_leaf_nodes": 4, "Type": "test", "Loss": 0.5263511942546167}, {"max_leaf_nodes": 5, "Type": "test", "Loss": 0.535176905972763}, {"max_leaf_nodes": 6, "Type": "test", "Loss": 0.5388224772306982}, {"max_leaf_nodes": 7, "Type": "test", "Loss": 0.5369306800820299}, {"max_leaf_nodes": 8, "Type": "test", "Loss": 0.5479616917491938}, {"max_leaf_nodes": 9, "Type": "test", "Loss": 0.540265147787404}, {"max_leaf_nodes": 10, "Type": "test", "Loss": 0.5424171804684005}, {"max_leaf_nodes": 11, "Type": "test", "Loss": 0.5545516075783523}, {"max_leaf_nodes": 12, "Type": "test", "Loss": 0.5498435420032475}, {"max_leaf_nodes": 13, "Type": "test", "Loss": 0.5343671732057992}, {"max_leaf_nodes": 14, "Type": "test", "Loss": 0.5317579847829019}, {"max_leaf_nodes": 15, "Type": "test", "Loss": 0.5364292874850652}, {"max_leaf_nodes": 16, "Type": "test", "Loss": 0.5258744683910608}, {"max_leaf_nodes": 17, "Type": "test", "Loss": 0.527098318808965}, {"max_leaf_nodes": 18, "Type": "test", "Loss": 0.7495556669471444}, {"max_leaf_nodes": 19, "Type": "test", "Loss": 0.7377957531487638}, {"max_leaf_nodes": 20, "Type": "test", "Loss": 0.9576040820366947}, {"max_leaf_nodes": 21, "Type": "test", "Loss": 0.954326249463554}, {"max_leaf_nodes": 22, "Type": "test", "Loss": 0.9506194572192963}, {"max_leaf_nodes": 23, "Type": "test", "Loss": 0.9535505392349978}, {"max_leaf_nodes": 24, "Type": "test", "Loss": 0.9416359882021362}, {"max_leaf_nodes": 25, "Type": "test", "Loss": 0.9468269838412242}, {"max_leaf_nodes": 26, "Type": "test", "Loss": 0.9525562783914784}, {"max_leaf_nodes": 27, "Type": "test", "Loss": 1.164434420534506}, {"max_leaf_nodes": 28, "Type": "test", "Loss": 1.155374888277803}, {"max_leaf_nodes": 29, "Type": "test", "Loss": 1.1313133408523859}, {"max_leaf_nodes": 30, "Type": "test", "Loss": 1.1390210033942476}, {"max_leaf_nodes": 31, "Type": "test", "Loss": 1.1368693336802578}, {"max_leaf_nodes": 32, "Type": "test", "Loss": 1.359279037072848}, {"max_leaf_nodes": 33, "Type": "test", "Loss": 1.3719375794377378}, {"max_leaf_nodes": 34, "Type": "test", "Loss": 1.3713186821662813}, {"max_leaf_nodes": 35, "Type": "test", "Loss": 1.3839153152492367}, {"max_leaf_nodes": 36, "Type": "test", "Loss": 1.997439742986651}, {"max_leaf_nodes": 37, "Type": "test", "Loss": 1.997439742986651}, {"max_leaf_nodes": 38, "Type": "test", "Loss": 2.1979177525153135}, {"max_leaf_nodes": 39, "Type": "test", "Loss": 2.2024187082332354}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Max_leaf_nodes = 5 is enough for the Decision Tree. After that, the difference between train and test curve is too large, which means overfitting the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_DT</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_DT</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Score: &quot;</span><span class="p">,</span> <span class="n">clf_DT</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Score: &quot;</span><span class="p">,</span> <span class="n">clf_DT</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Score:  0.7719869706840391
Test Score:  0.7727272727272727
</pre></div>
</div>
</div>
</div>
<p>Decision Tree gets 77.27% accuracy on test data. We store the predict result and accuracy for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT_acc</span> <span class="o">=</span> <span class="n">clf_DT</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
<span class="n">DT_result</span> <span class="o">=</span> <span class="n">clf_DT</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the Decison Tree by plot_tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot_tree</span><span class="p">(</span><span class="n">clf_DT</span><span class="p">,</span> 
                   <span class="n">feature_names</span><span class="o">=</span><span class="n">clf_DT</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">,</span>
                   <span class="n">class_names</span><span class="o">=</span><span class="n">clf_DT</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
                   <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/YifengXiong_42_0.png" src="../../_images/YifengXiong_42_0.png" />
</div>
</div>
<p>Based on the graph, Glucose, Age and BMI are the features that been used in the Decision Tree. It seems these three features are the most important in the dataset. We also want numerical data to support the conclusion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clf_DT</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">clf_DT</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pregnancies                 0.000000
Glucose                     0.565357
BloodPressure               0.000000
SkinThickness               0.000000
Insulin                     0.000000
BMI                         0.272307
DiabetesPedigreeFunction    0.000000
Age                         0.162336
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Thus, we can say the importance is: Glucose &gt; BMI &gt; Age.</p>
</section>
<section id="part-2-random-forest">
<h2>Part 2: Random Forest<a class="headerlink" href="#part-2-random-forest" title="Permalink to this headline">#</a></h2>
<p>The next model we will try is random forest. Decision Tree gives a good result, and I expect Random Forest will do better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RF_train_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">RF_test_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
    <span class="n">train_error</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">),</span> <span class="n">_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
    <span class="n">RF_train_dict</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_error</span>
    <span class="n">test_error</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">),</span> <span class="n">_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
    <span class="n">RF_test_dict</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_error</span>
<span class="n">train_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">RF_train_dict</span><span class="p">)</span>
<span class="n">test_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">RF_test_dict</span><span class="p">)</span>
<span class="n">train_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
<span class="n">test_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">df_loss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_ser</span><span class="p">,</span> <span class="n">test_ser</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_loss</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_loss</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_melted</span> <span class="o">=</span> <span class="n">df_loss</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">c_RF</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_melted</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;max_leaf_nodes&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">])),</span> 
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Type&quot;</span>
<span class="p">)</span>
<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">c_RF</span><span class="p">,</span> <span class="n">c_DT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7325c7e845114ee4b0a60e3927d4f8d5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7325c7e845114ee4b0a60e3927d4f8d5") {
      outputDiv = document.getElementById("altair-viz-7325c7e845114ee4b0a60e3927d4f8d5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"data": {"name": "data-132c7ad29272ed6b1439efb8245982ef"}, "mark": "line", "encoding": {"color": {"field": "Type", "type": "nominal"}, "x": {"field": "max_leaf_nodes", "type": "quantitative"}, "y": {"field": "Loss", "scale": {"domain": [0.0, 2.4]}, "type": "quantitative"}}}, {"data": {"name": "data-0d9265e724fb75935957eca9c04e8d3f"}, "mark": "line", "encoding": {"color": {"field": "Type", "type": "nominal"}, "x": {"field": "max_leaf_nodes", "type": "quantitative"}, "y": {"field": "Loss", "type": "quantitative"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-132c7ad29272ed6b1439efb8245982ef": [{"max_leaf_nodes": 2, "Type": "train", "Loss": 0.5567545050420522}, {"max_leaf_nodes": 3, "Type": "train", "Loss": 0.5146977487301743}, {"max_leaf_nodes": 4, "Type": "train", "Loss": 0.4909921184000671}, {"max_leaf_nodes": 5, "Type": "train", "Loss": 0.47429173542887043}, {"max_leaf_nodes": 6, "Type": "train", "Loss": 0.4608932188198996}, {"max_leaf_nodes": 7, "Type": "train", "Loss": 0.44885210620452587}, {"max_leaf_nodes": 8, "Type": "train", "Loss": 0.43855210431953817}, {"max_leaf_nodes": 9, "Type": "train", "Loss": 0.4302906414047506}, {"max_leaf_nodes": 10, "Type": "train", "Loss": 0.4220229876303107}, {"max_leaf_nodes": 11, "Type": "train", "Loss": 0.41445886086585637}, {"max_leaf_nodes": 12, "Type": "train", "Loss": 0.40771853932970586}, {"max_leaf_nodes": 13, "Type": "train", "Loss": 0.40133779750780096}, {"max_leaf_nodes": 14, "Type": "train", "Loss": 0.39439956591158143}, {"max_leaf_nodes": 15, "Type": "train", "Loss": 0.387481036575551}, {"max_leaf_nodes": 16, "Type": "train", "Loss": 0.38149475954306444}, {"max_leaf_nodes": 17, "Type": "train", "Loss": 0.3757443781270455}, {"max_leaf_nodes": 18, "Type": "train", "Loss": 0.37005898960095635}, {"max_leaf_nodes": 19, "Type": "train", "Loss": 0.36360729038617645}, {"max_leaf_nodes": 20, "Type": "train", "Loss": 0.3580143302180627}, {"max_leaf_nodes": 21, "Type": "train", "Loss": 0.352228290709283}, {"max_leaf_nodes": 22, "Type": "train", "Loss": 0.3470092452306022}, {"max_leaf_nodes": 23, "Type": "train", "Loss": 0.3419006535240192}, {"max_leaf_nodes": 24, "Type": "train", "Loss": 0.33706968399455167}, {"max_leaf_nodes": 25, "Type": "train", "Loss": 0.33247395860641926}, {"max_leaf_nodes": 26, "Type": "train", "Loss": 0.3281275607683737}, {"max_leaf_nodes": 27, "Type": "train", "Loss": 0.32351521660189886}, {"max_leaf_nodes": 28, "Type": "train", "Loss": 0.31940764186226894}, {"max_leaf_nodes": 29, "Type": "train", "Loss": 0.3149655975774648}, {"max_leaf_nodes": 30, "Type": "train", "Loss": 0.3109019410502975}, {"max_leaf_nodes": 31, "Type": "train", "Loss": 0.30671465720673435}, {"max_leaf_nodes": 32, "Type": "train", "Loss": 0.302409097826539}, {"max_leaf_nodes": 33, "Type": "train", "Loss": 0.29817644026443213}, {"max_leaf_nodes": 34, "Type": "train", "Loss": 0.2938868665276672}, {"max_leaf_nodes": 35, "Type": "train", "Loss": 0.2900448999634135}, {"max_leaf_nodes": 36, "Type": "train", "Loss": 0.2862438228142853}, {"max_leaf_nodes": 37, "Type": "train", "Loss": 0.28249657107801746}, {"max_leaf_nodes": 38, "Type": "train", "Loss": 0.2787619212573032}, {"max_leaf_nodes": 39, "Type": "train", "Loss": 0.27517570894790466}, {"max_leaf_nodes": 2, "Type": "test", "Loss": 0.5702685126021366}, {"max_leaf_nodes": 3, "Type": "test", "Loss": 0.5369191523999353}, {"max_leaf_nodes": 4, "Type": "test", "Loss": 0.5193486670793478}, {"max_leaf_nodes": 5, "Type": "test", "Loss": 0.50972839747424}, {"max_leaf_nodes": 6, "Type": "test", "Loss": 0.5026129329787079}, {"max_leaf_nodes": 7, "Type": "test", "Loss": 0.4976270251088882}, {"max_leaf_nodes": 8, "Type": "test", "Loss": 0.49391826843252706}, {"max_leaf_nodes": 9, "Type": "test", "Loss": 0.4908336563673505}, {"max_leaf_nodes": 10, "Type": "test", "Loss": 0.4881636745681454}, {"max_leaf_nodes": 11, "Type": "test", "Loss": 0.4869364774537983}, {"max_leaf_nodes": 12, "Type": "test", "Loss": 0.4852924607016528}, {"max_leaf_nodes": 13, "Type": "test", "Loss": 0.48396797767037913}, {"max_leaf_nodes": 14, "Type": "test", "Loss": 0.4835239102619686}, {"max_leaf_nodes": 15, "Type": "test", "Loss": 0.48373375108482775}, {"max_leaf_nodes": 16, "Type": "test", "Loss": 0.48445403254925307}, {"max_leaf_nodes": 17, "Type": "test", "Loss": 0.48429360211782685}, {"max_leaf_nodes": 18, "Type": "test", "Loss": 0.4847638639557556}, {"max_leaf_nodes": 19, "Type": "test", "Loss": 0.4832196470856721}, {"max_leaf_nodes": 20, "Type": "test", "Loss": 0.4828468947368033}, {"max_leaf_nodes": 21, "Type": "test", "Loss": 0.48277377172014135}, {"max_leaf_nodes": 22, "Type": "test", "Loss": 0.48181441329097263}, {"max_leaf_nodes": 23, "Type": "test", "Loss": 0.48161056795724216}, {"max_leaf_nodes": 24, "Type": "test", "Loss": 0.4821306686629966}, {"max_leaf_nodes": 25, "Type": "test", "Loss": 0.4825513405830303}, {"max_leaf_nodes": 26, "Type": "test", "Loss": 0.48319997271607207}, {"max_leaf_nodes": 27, "Type": "test", "Loss": 0.4836792422167815}, {"max_leaf_nodes": 28, "Type": "test", "Loss": 0.4832540794683222}, {"max_leaf_nodes": 29, "Type": "test", "Loss": 0.4834073780974185}, {"max_leaf_nodes": 30, "Type": "test", "Loss": 0.48378533266592233}, {"max_leaf_nodes": 31, "Type": "test", "Loss": 0.48495306372401537}, {"max_leaf_nodes": 32, "Type": "test", "Loss": 0.48541613996520955}, {"max_leaf_nodes": 33, "Type": "test", "Loss": 0.4856325148957707}, {"max_leaf_nodes": 34, "Type": "test", "Loss": 0.48536695976747174}, {"max_leaf_nodes": 35, "Type": "test", "Loss": 0.4852824674164774}, {"max_leaf_nodes": 36, "Type": "test", "Loss": 0.4844440077488722}, {"max_leaf_nodes": 37, "Type": "test", "Loss": 0.48437120893864744}, {"max_leaf_nodes": 38, "Type": "test", "Loss": 0.48440570564801355}, {"max_leaf_nodes": 39, "Type": "test", "Loss": 0.48310222696565425}], "data-0d9265e724fb75935957eca9c04e8d3f": [{"max_leaf_nodes": 2, "Type": "train", "Loss": 0.5569860248785248}, {"max_leaf_nodes": 3, "Type": "train", "Loss": 0.5313186041835257}, {"max_leaf_nodes": 4, "Type": "train", "Loss": 0.49370636968084897}, {"max_leaf_nodes": 5, "Type": "train", "Loss": 0.47321705031427164}, {"max_leaf_nodes": 6, "Type": "train", "Loss": 0.45969557188187055}, {"max_leaf_nodes": 7, "Type": "train", "Loss": 0.44650790211346936}, {"max_leaf_nodes": 8, "Type": "train", "Loss": 0.43643834632684236}, {"max_leaf_nodes": 9, "Type": "train", "Loss": 0.4290428271270009}, {"max_leaf_nodes": 10, "Type": "train", "Loss": 0.42202930032837294}, {"max_leaf_nodes": 11, "Type": "train", "Loss": 0.41068539332938336}, {"max_leaf_nodes": 12, "Type": "train", "Loss": 0.403814097237769}, {"max_leaf_nodes": 13, "Type": "train", "Loss": 0.39279315846059637}, {"max_leaf_nodes": 14, "Type": "train", "Loss": 0.382404712063433}, {"max_leaf_nodes": 15, "Type": "train", "Loss": 0.37484259286787586}, {"max_leaf_nodes": 16, "Type": "train", "Loss": 0.3574460958198201}, {"max_leaf_nodes": 17, "Type": "train", "Loss": 0.3513971654101233}, {"max_leaf_nodes": 18, "Type": "train", "Loss": 0.34588277302338316}, {"max_leaf_nodes": 19, "Type": "train", "Loss": 0.3381144606955513}, {"max_leaf_nodes": 20, "Type": "train", "Loss": 0.3333330625975844}, {"max_leaf_nodes": 21, "Type": "train", "Loss": 0.32889064243393834}, {"max_leaf_nodes": 22, "Type": "train", "Loss": 0.32397297126127084}, {"max_leaf_nodes": 23, "Type": "train", "Loss": 0.3194493672772505}, {"max_leaf_nodes": 24, "Type": "train", "Loss": 0.31500694711360444}, {"max_leaf_nodes": 25, "Type": "train", "Loss": 0.31137536002364513}, {"max_leaf_nodes": 26, "Type": "train", "Loss": 0.30481647346956964}, {"max_leaf_nodes": 27, "Type": "train", "Loss": 0.298596465310337}, {"max_leaf_nodes": 28, "Type": "train", "Loss": 0.29483637349437786}, {"max_leaf_nodes": 29, "Type": "train", "Loss": 0.2874886400928215}, {"max_leaf_nodes": 30, "Type": "train", "Loss": 0.28254855764995684}, {"max_leaf_nodes": 31, "Type": "train", "Loss": 0.2793372864551636}, {"max_leaf_nodes": 32, "Type": "train", "Loss": 0.27201044418}, {"max_leaf_nodes": 33, "Type": "train", "Loss": 0.2678681719229957}, {"max_leaf_nodes": 34, "Type": "train", "Loss": 0.2624105219704849}, {"max_leaf_nodes": 35, "Type": "train", "Loss": 0.25804298382623225}, {"max_leaf_nodes": 36, "Type": "train", "Loss": 0.25149522206546343}, {"max_leaf_nodes": 37, "Type": "train", "Loss": 0.24742028376303515}, {"max_leaf_nodes": 38, "Type": "train", "Loss": 0.24334534546060696}, {"max_leaf_nodes": 39, "Type": "train", "Loss": 0.24023534138099062}, {"max_leaf_nodes": 2, "Type": "test", "Loss": 0.5527618465588776}, {"max_leaf_nodes": 3, "Type": "test", "Loss": 0.5290574547788799}, {"max_leaf_nodes": 4, "Type": "test", "Loss": 0.5263511942546167}, {"max_leaf_nodes": 5, "Type": "test", "Loss": 0.535176905972763}, {"max_leaf_nodes": 6, "Type": "test", "Loss": 0.5388224772306982}, {"max_leaf_nodes": 7, "Type": "test", "Loss": 0.5369306800820299}, {"max_leaf_nodes": 8, "Type": "test", "Loss": 0.5479616917491938}, {"max_leaf_nodes": 9, "Type": "test", "Loss": 0.540265147787404}, {"max_leaf_nodes": 10, "Type": "test", "Loss": 0.5424171804684005}, {"max_leaf_nodes": 11, "Type": "test", "Loss": 0.5545516075783523}, {"max_leaf_nodes": 12, "Type": "test", "Loss": 0.5498435420032475}, {"max_leaf_nodes": 13, "Type": "test", "Loss": 0.5343671732057992}, {"max_leaf_nodes": 14, "Type": "test", "Loss": 0.5317579847829019}, {"max_leaf_nodes": 15, "Type": "test", "Loss": 0.5364292874850652}, {"max_leaf_nodes": 16, "Type": "test", "Loss": 0.5258744683910608}, {"max_leaf_nodes": 17, "Type": "test", "Loss": 0.527098318808965}, {"max_leaf_nodes": 18, "Type": "test", "Loss": 0.7495556669471444}, {"max_leaf_nodes": 19, "Type": "test", "Loss": 0.7377957531487638}, {"max_leaf_nodes": 20, "Type": "test", "Loss": 0.9576040820366947}, {"max_leaf_nodes": 21, "Type": "test", "Loss": 0.954326249463554}, {"max_leaf_nodes": 22, "Type": "test", "Loss": 0.9506194572192963}, {"max_leaf_nodes": 23, "Type": "test", "Loss": 0.9535505392349978}, {"max_leaf_nodes": 24, "Type": "test", "Loss": 0.9416359882021362}, {"max_leaf_nodes": 25, "Type": "test", "Loss": 0.9468269838412242}, {"max_leaf_nodes": 26, "Type": "test", "Loss": 0.9525562783914784}, {"max_leaf_nodes": 27, "Type": "test", "Loss": 1.164434420534506}, {"max_leaf_nodes": 28, "Type": "test", "Loss": 1.155374888277803}, {"max_leaf_nodes": 29, "Type": "test", "Loss": 1.1313133408523859}, {"max_leaf_nodes": 30, "Type": "test", "Loss": 1.1390210033942476}, {"max_leaf_nodes": 31, "Type": "test", "Loss": 1.1368693336802578}, {"max_leaf_nodes": 32, "Type": "test", "Loss": 1.359279037072848}, {"max_leaf_nodes": 33, "Type": "test", "Loss": 1.3719375794377378}, {"max_leaf_nodes": 34, "Type": "test", "Loss": 1.3713186821662813}, {"max_leaf_nodes": 35, "Type": "test", "Loss": 1.3839153152492367}, {"max_leaf_nodes": 36, "Type": "test", "Loss": 1.997439742986651}, {"max_leaf_nodes": 37, "Type": "test", "Loss": 1.997439742986651}, {"max_leaf_nodes": 38, "Type": "test", "Loss": 2.1979177525153135}, {"max_leaf_nodes": 39, "Type": "test", "Loss": 2.2024187082332354}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>The left figure above is the training and test loss for Random Forest, while the right figure is the loss for Decision Tree. We can see the training loss are decreasing similarly, but the test loss is significantly different. These figures shows how Random Forest prevent models from overfitting.</p>
<p>I test nodes from 3 to 10, 7 gives the best result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_RF</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_RF</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Score: &quot;</span><span class="p">,</span> <span class="n">clf_RF</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Score: &quot;</span><span class="p">,</span> <span class="n">clf_RF</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Score:  0.8029315960912052
Test Score:  0.7857142857142857
</pre></div>
</div>
</div>
</div>
<p>Random Forest doesn’t get much improve in this task. It gets 78.57% accuracy on the test dataset. But it shows how good it is for prevent overfitting. We store the result for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RF_acc</span> <span class="o">=</span> <span class="n">clf_RF</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">))</span>
<span class="n">RF_result</span> <span class="o">=</span> <span class="n">clf_RF</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Similar to Random Forest, let’s take a look at the feature importance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clf_RF</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">clf_RF</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pregnancies                 0.052909
Glucose                     0.401967
BloodPressure               0.031670
SkinThickness               0.022298
Insulin                     0.054308
BMI                         0.186646
DiabetesPedigreeFunction    0.050335
Age                         0.199866
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We get very similar conclusion to Random Forest. But in Random Forest, Age seems to be a little much important than BMI.</p>
</section>
<section id="part-3-kmeans">
<h2>Part 3: Kmeans<a class="headerlink" href="#part-3-kmeans" title="Permalink to this headline">#</a></h2>
<p>In this part, we use Kmeans to do clustering on the dataset. We will use the top 3 important features for kmeans training.</p>
<p>Firstly, we will create a dataframe with the columns we want. Note that range affects the performance of Kmeans, so we will use the scaled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span> <span class="s2">&quot;BMI&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="n">X_train_scaled_kmeans</span> <span class="o">=</span> <span class="n">X_train_scaled</span><span class="p">[</span><span class="n">kmeans_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Then we will initiate a kmeans class with n_clusters = 2. The reason that we set it to 2 is because we know there will be two classes: positive for diabetes or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled_kmeans</span><span class="p">)</span>
<span class="n">X_train_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled_kmeans</span><span class="p">)</span>
<span class="n">X_train_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before calculating the accuracy of the kmeans method, there is one more thing we need to do. Since Kmeans is an unsupervised method, it will divide the data into two clusters, but which one is class 1 has no difference. So we will plot the prediction and see which class it predict is more likely to be “positive” in the training data.</p>
<p>We choose Glucose and BMI for x and y axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_kmeans</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y:N&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_kmeans</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y_predict:N&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">,</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-bf15082e2d39443cad7839bd34be7063"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bf15082e2d39443cad7839bd34be7063") {
      outputDiv = document.getElementById("altair-viz-bf15082e2d39443cad7839bd34be7063");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"mark": "circle", "encoding": {"color": {"field": "y", "type": "nominal"}, "tooltip": [{"field": "y", "type": "quantitative"}, {"field": "Glucose", "type": "quantitative"}, {"field": "BMI", "type": "quantitative"}, {"field": "Age", "type": "quantitative"}], "x": {"field": "Glucose", "type": "quantitative"}, "y": {"field": "BMI", "type": "quantitative"}}}, {"mark": "circle", "encoding": {"color": {"field": "y_predict", "type": "nominal"}, "tooltip": [{"field": "y_predict", "type": "quantitative"}, {"field": "Glucose", "type": "quantitative"}, {"field": "BMI", "type": "quantitative"}, {"field": "Age", "type": "quantitative"}], "x": {"field": "Glucose", "type": "quantitative"}, "y": {"field": "BMI", "type": "quantitative"}}}], "data": {"name": "data-984f7fc72970506c2243c173a17a8b2c"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-984f7fc72970506c2243c173a17a8b2c": [{"Glucose": -1.1513979239961076, "BMI": -4.135255778599698, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": -0.4891688057566077, "Age": 1.4871008455407202, "y_predict": 0, "y": 1}, {"Glucose": 0.5668710182173597, "BMI": -0.42452187361399973, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.2541785951027467, "BMI": -1.3037201507534686, "Age": 2.79212216878322, "y_predict": 0, "y": 0}, {"Glucose": 0.4106647507434082, "BMI": 1.8381207513772806, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": -0.7865446936126046, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.34818224375382756, "BMI": 0.11851235638390734, "Age": -0.8619375362957792, "y_predict": 1, "y": 1}, {"Glucose": 1.2541785951027467, "BMI": -0.8382622393266908, "Age": 1.2260965808922204, "y_predict": 0, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": 0.45467640352546906, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -1.276362937975269, "BMI": -1.665742970752073, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": 0.6744759728103367, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.5665911300506499, "BMI": 1.5019567042357187, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": -1.0264329100169465, "BMI": -0.38573371432843484, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.785559792680892, "BMI": -0.3986631007569566, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 2.191416199946456, "BMI": -0.14007537218652463, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.17022990209799355, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 1.1916960881131662, "BMI": -0.5926038971847806, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.11851235638390734, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.0021478785272131297, "Age": 0.18207952229822058, "y_predict": 1, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 3.273282644943177, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 1.0667310741340048, "BMI": 0.8684167692381606, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": -0.34694555504286995, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": 0.23487683424060155, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.25643985004321884, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.5265728541003013, "BMI": -0.2693692364717406, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 0.31694099025903727, "BMI": -0.049569667186873084, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": -1.2649319914679036, "Age": 2.09611079638722, "y_predict": 0, "y": 0}, {"Glucose": 0.9730073136496339, "BMI": 1.230439589236765, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.8684167692381606, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": 2.2389317306614496, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 1.4631685449501535, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": -0.15300475861504598, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.276362937975269, "BMI": -0.25643985004321884, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": 0.6356878135247713, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 2.2851399604308273, "BMI": -1.0968499678971229, "Age": 2.27011363948622, "y_predict": 0, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.20901806138355888, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": -1.3388454449648495, "BMI": -0.12714598575800287, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": -0.46409034711072067, "BMI": -0.7994740800411259, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 1.0235694063804193, "Age": 0.9650923162437204, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 0.40295885781138285, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.8699467543762849, "BMI": 0.3124531528117313, "Age": 1.1390951593427203, "y_predict": 1, "y": 0}, {"Glucose": -1.2451216844804787, "BMI": -0.24351046361469705, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.589055361089882, "BMI": -4.135255778599698, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.825332852898169, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": 0.5968996542392069, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 1.5353498765558595, "BMI": 0.3253825392402531, "Age": -0.2529275854492793, "y_predict": 0, "y": 1}, {"Glucose": -1.1201566705013173, "BMI": -0.24351046361469705, "Age": 0.18207952229822058, "y_predict": 1, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 0.3253825392402531, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": 0.4676057899539909, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": 0.19197597627987598, "BMI": -0.5538157378992157, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.3794234972486179, "BMI": 1.0623575656659847, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": -0.049569667186873084, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.182639177490898, "BMI": 0.29952376638320954, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.06701096230071471, "BMI": 0.41588824423990467, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": 2.066451185967295, "BMI": 0.7391229049529446, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": 0.9730073136496339, "BMI": -0.6701802157559099, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 0.15730051566947267, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.7132641320959011, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.32108678218582687, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.954626717183385, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": 0.5968996542392069, "Age": 1.5741022670902203, "y_predict": 0, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": -1.31664953718199, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.379143609081908, "BMI": 2.6268133235170974, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.19179291790061084, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 0.5043885112277792, "BMI": -0.10128721290095975, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 1.8165211580089724, "BMI": 0.40295885781138285, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": 1.5665911300506499, "BMI": 0.17022990209799355, "Age": -0.7749361147462792, "y_predict": 0, "y": 1}, {"Glucose": -1.182639177490898, "BMI": -0.34694555504286995, "Age": 0.2690809438477206, "y_predict": 1, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.0063442628974717, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.19179291790061084, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -1.2261438321823388, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 0.8425579963811171, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": 0.053865424241299344, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": 0.3641706985258175, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": 0.19197597627987598, "BMI": 0.5581114949536415, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": -0.15300475861504598, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": -1.3700866984596398, "BMI": 0.4934645628110335, "Age": 0.18207952229822058, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -1.0451324221830365, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 0.6356878135247713, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 0.44190600423819854, "BMI": 1.3338746806649375, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": 0.31694099025903727, "BMI": 0.1443711292409509, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": 1.4631685449501535, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": -1.2138804309856883, "BMI": -0.4503806464710428, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": -1.407155242181641, "Age": 1.9221079532882202, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.40295885781138285, "Age": -0.2529275854492793, "y_predict": 1, "y": 1}, {"Glucose": 0.5356297647225695, "BMI": 0.5581114949536415, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.9416973307548637, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -0.954626717183385, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.3794234972486179, "BMI": 0.11851235638390734, "Age": 0.5300852084962205, "y_predict": 0, "y": 1}, {"Glucose": -0.30788407963676906, "BMI": -0.7477565343270397, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": 0.4417470170969473, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 0.2736649935261669, "Age": 0.4430837869467205, "y_predict": 0, "y": 0}, {"Glucose": 1.379143609081908, "BMI": 2.0579203206621473, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.3703665866263497, "BMI": -1.148567513611209, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.3391253331315594, "BMI": -0.540886351470694, "Age": 2.18311221793672, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.9589224742378113, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": 0.3900294713828611, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -3.775663217558494, "BMI": -0.5538157378992157, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": 0.37710008495433933, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.6202966145846722, "BMI": -1.0063442628974717, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": -1.0322030357545149, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": -0.4115924871854779, "Age": 2.44411648258522, "y_predict": 0, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -1.277861377896425, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": -0.24351046361469705, "Age": 1.2260965808922204, "y_predict": 0, "y": 1}, {"Glucose": -1.3388454449648495, "BMI": 0.06679481066982113, "Age": 0.5300852084962205, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.8511916257552126, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": 1.3468040670934591, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 0.5839702678106851, "Age": 0.35608236539722055, "y_predict": 0, "y": 1}, {"Glucose": -1.1201566705013173, "BMI": -0.10128721290095975, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": -1.31664953718199, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -1.083920581468601, "Age": 0.9650923162437204, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.29522800932878374, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": 0.4417470170969473, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": 1.6312505685209349, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -1.3076041914700591, "BMI": 0.0021478785272131297, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": 0.6227584270962495, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": -0.5150275786136508, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": 0.9847812470948548, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 1.2229373416079565, "BMI": -0.19179291790061084, "Age": 0.5300852084962205, "y_predict": 0, "y": 1}, {"Glucose": 1.285419848597537, "BMI": -0.9934148764689499, "Age": 1.4871008455407202, "y_predict": 0, "y": 1}, {"Glucose": -1.2451216844804787, "BMI": 1.9027676835198886, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -0.15300475861504598, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -0.7089683750414748, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.7230772856913114, "BMI": 0.8425579963811171, "Age": 0.35608236539722055, "y_predict": 0, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": -1.0580618086115579, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": 0.4106647507434082, "BMI": -0.7218977614699966, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.19197597627987598, "BMI": 0.3124531528117313, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.8477624115037627, "BMI": 0.5839702678106851, "Age": 0.18207952229822058, "y_predict": 0, "y": 1}, {"Glucose": 1.472867369566279, "BMI": 0.7779110642385091, "Age": 0.0950781007487206, "y_predict": 0, "y": 1}, {"Glucose": 1.5665911300506499, "BMI": 1.7346856599491072, "Age": 1.83510653173872, "y_predict": 0, "y": 1}, {"Glucose": -0.46409034711072067, "BMI": -1.2002850593252956, "Age": 1.3130980024417203, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.30815739575730505, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": 2.3163812139256175, "BMI": -0.14007537218652463, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 0.06679481066982113, "Age": 3.22712927653072, "y_predict": 0, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": -1.5493784928953787, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": 1.682968114235021, "Age": 1.2260965808922204, "y_predict": 0, "y": 0}, {"Glucose": -1.276362937975269, "BMI": 1.0106400199518975, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -1.4013279519544302, "BMI": 0.10558296995538555, "Age": 0.7040880515952205, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 4.540362514938294, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": -1.088915417006527, "BMI": 1.2045808163797214, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 0.5710408813821632, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": -0.42452187361399973, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": -0.42452187361399973, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 2.1289336929568754, "BMI": 0.29952376638320954, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": -0.25643985004321884, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": -0.7865446936126046, "Age": 0.5300852084962205, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.24351046361469705, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 0.7230772856913114, "BMI": 0.0021478785272131297, "Age": 2.18311221793672, "y_predict": 0, "y": 1}, {"Glucose": 2.1289336929568754, "BMI": -0.10128721290095975, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -0.6202966145846722, "BMI": -1.4200846286101627, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.8641210121837339, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -1.4950517124388012, "BMI": -1.407155242181641, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -3.775663217558494, "BMI": 0.0021478785272131297, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -1.601096038609465, "Age": 3.4011321196297195, "y_predict": 0, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": -4.135255778599698, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -4.135255778599698, "Age": 1.83510653173872, "y_predict": 1, "y": 1}, {"Glucose": -0.30788407963676906, "BMI": -0.24351046361469705, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 2.347622467420408, "BMI": 1.0106400199518975, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": -0.049569667186873084, "Age": 2.87912359033272, "y_predict": 0, "y": 1}, {"Glucose": -0.7452616285638335, "BMI": -1.7821074486087676, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.004528455311134083, "BMI": 0.907204928523725, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.7736153071840828, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.9417660601548435, "BMI": 1.4114509992360673, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": -0.5578141075950916, "BMI": -0.566745124327737, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -1.4976609471812925, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": -0.8770503986122556, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.4106647507434082, "BMI": -1.0580618086115579, "Age": 2.35711506103572, "y_predict": 0, "y": 1}, {"Glucose": 0.3794234972486179, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 1.4631685449501535, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": -4.135255778599698, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.6443214428988668, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": -0.566745124327737, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": 1.489027317807197, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.2607356070976451, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 1.0042485671444241, "BMI": 1.1140751113800709, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -3.775663217558494, "BMI": -0.9416973307548637, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 1.1140751113800709, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.5265728541003013, "BMI": -0.540886351470694, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -1.601096038609465, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": -0.20472230432913263, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": -0.5279569650421726, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": -0.8770503986122556, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.879003664998553, "BMI": 0.5063939492395553, "Age": 1.5741022670902203, "y_predict": 0, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": 0.6615465863818148, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": -0.46409034711072067, "BMI": 0.28659437995468867, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -1.3388454449648495, "BMI": 0.22194744781208067, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": 2.9759067570871807, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": -0.5796745107562589, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": 0.5322527220965989, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": 1.3479023555871177, "BMI": -0.15300475861504598, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": 0.8480422996704726, "BMI": 0.20901806138355888, "Age": 1.4871008455407202, "y_predict": 0, "y": 1}, {"Glucose": 2.160174946451666, "BMI": 0.45467640352546906, "Age": 2.87912359033272, "y_predict": 0, "y": 1}, {"Glucose": -1.2451216844804787, "BMI": -0.5796745107562589, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -1.6512579799127527, "BMI": 0.45467640352546906, "Age": 1.2260965808922204, "y_predict": 1, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": -0.9675561036119068, "Age": 0.2690809438477206, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.9158385578978205, "Age": 2.09611079638722, "y_predict": 0, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": -0.540886351470694, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": 0.2607356070976451, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": 2.378863720915198, "BMI": 0.6098290406677287, "Age": -0.16592616389977932, "y_predict": 0, "y": 0}, {"Glucose": 2.0352099324725046, "BMI": 0.3253825392402531, "Age": 0.35608236539722055, "y_predict": 0, "y": 1}, {"Glucose": 0.19197597627987598, "BMI": 0.3253825392402531, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.9327091495325754, "BMI": -0.282298622900262, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.28659437995468867, "Age": 1.6611036886397201, "y_predict": 0, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": 0.7908404506670308, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -0.282298622900262, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.0354898206392145, "BMI": 0.10558296995538555, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 0.34818224375382756, "BMI": -0.5150275786136508, "Age": 2.61811932568422, "y_predict": 0, "y": 0}, {"Glucose": 1.6290736370402306, "BMI": 0.6227584270962495, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": 1.5041086230610692, "BMI": -0.2693692364717406, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": -0.30815739575730505, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": -0.889979785040777, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -0.7218977614699966, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -0.9287679443263419, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.276362937975269, "BMI": -0.7477565343270397, "Age": 0.7040880515952205, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": 1.7217562735205854, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 0.785559792680892, "BMI": -0.29522800932878374, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": -3.775663217558494, "BMI": 1.165792657094157, "Age": 0.35608236539722055, "y_predict": 1, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": -4.135255778599698, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 2.0976924394620853, "BMI": 0.0021478785272131297, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": -0.25643985004321884, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": 0.9589224742378113, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -0.8702266425429948, "BMI": -0.20472230432913263, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 1.1292135811235855, "BMI": 0.9589224742378113, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": 0.7230772856913114, "BMI": -0.32108678218582687, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 1.230439589236765, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.3794234972486179, "BMI": -0.6443214428988668, "Age": 0.2690809438477206, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": 0.22194744781208067, "Age": 0.6170866300457205, "y_predict": 0, "y": 1}, {"Glucose": 1.3166611020923273, "BMI": 0.907204928523725, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 3.5447997599421313, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": 1.8251913649487588, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": 0.053865424241299344, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": -0.15300475861504598, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": 0.9201343149522468, "Age": 0.35608236539722055, "y_predict": 0, "y": 1}, {"Glucose": 0.9105248066600533, "BMI": -1.4200846286101627, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -1.2138804309856883, "BMI": -1.407155242181641, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": -0.29522800932878374, "Age": -0.2529275854492793, "y_predict": 1, "y": 1}, {"Glucose": -0.589055361089882, "BMI": 0.971851860666333, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": -0.6055332836133019, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.24540157264718845, "BMI": 0.17022990209799355, "Age": -0.8619375362957792, "y_predict": 1, "y": 1}, {"Glucose": 1.660314890535021, "BMI": 0.11851235638390734, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": 1.0354898206392145, "BMI": -0.14007537218652463, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": 2.2851399604308273, "BMI": 0.5063939492395553, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.9327091495325754, "BMI": 0.4676057899539909, "Age": 3.0531264334317196, "y_predict": 0, "y": 0}, {"Glucose": 1.4103848625766984, "BMI": -0.696038988612953, "Age": 2.87912359033272, "y_predict": 0, "y": 0}, {"Glucose": 0.5981122717121501, "BMI": 0.7003347456673793, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": 0.06701096230071471, "BMI": 0.5581114949536415, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": -0.05795405167844655, "BMI": 0.45467640352546906, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": -0.6184626700418238, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.8702266425429948, "BMI": 0.7779110642385091, "Age": -0.8619375362957792, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": 0.06679481066982113, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.971851860666333, "Age": 0.4430837869467205, "y_predict": 0, "y": 0}, {"Glucose": 2.2538987069360368, "BMI": 0.37710008495433933, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.3986631007569566, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": -0.5796745107562589, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": 0.3383119256687749, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": -1.0576741635117366, "BMI": -0.3986631007569566, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.34818224375382756, "BMI": 0.053865424241299344, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.0667310741340048, "BMI": -0.696038988612953, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.0021478785272131297, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": 2.066451185967295, "BMI": 0.24780622066912333, "Age": 0.0950781007487206, "y_predict": 0, "y": 1}, {"Glucose": 0.5668710182173597, "BMI": -0.631392056470345, "Age": 2.09611079638722, "y_predict": 0, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.3037201507534686, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 2.378863720915198, "BMI": -0.7865446936126046, "Age": 0.5300852084962205, "y_predict": 0, "y": 1}, {"Glucose": -0.026712798183656235, "BMI": 0.9977106335233766, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": 1.3855922263790246, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -0.11421659932948107, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": -1.0322030357545149, "Age": 0.18207952229822058, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.46331003289956463, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": 0.8037698370955526, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": -0.43745126004252105, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.9727274254829241, "BMI": -0.25643985004321884, "Age": 1.4000994239912203, "y_predict": 0, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.5968996542392069, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 0.29952376638320954, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -0.6184626700418238, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -0.7348271478985179, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -1.1614969000397308, "Age": 0.6170866300457205, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": 1.9156970699484095, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": 2.0976924394620853, "BMI": 2.0579203206621473, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": -0.026712798183656235, "BMI": 1.4114509992360673, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": 1.1528632706656352, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": -0.8077441355534142, "BMI": -0.7865446936126046, "Age": 0.2690809438477206, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -1.2649319914679036, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": 1.7605444328061508, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -1.4013279519544302, "BMI": 0.2607356070976451, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -0.566745124327737, "Age": 1.4000994239912203, "y_predict": 0, "y": 1}, {"Glucose": -1.3076041914700591, "BMI": 1.489027317807197, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 2.347622467420408, "BMI": 0.5839702678106851, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -1.2138804309856883, "BMI": -1.3942258557531197, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 1.9156970699484095, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": 1.7217562735205854, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -0.8770503986122556, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": 0.785559792680892, "BMI": 0.7649816778099873, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": -0.30815739575730505, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": 0.28659437995468867, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": -0.5926038971847806, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": -0.24540157264718845, "BMI": 0.20901806138355888, "Age": -1.035940379394779, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": 0.7261935185244228, "Age": 1.5741022670902203, "y_predict": 0, "y": 0}, {"Glucose": 1.9414861719881338, "BMI": 1.1399338842371134, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": -1.7449817403971237, "BMI": 0.0021478785272131297, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -1.213214445753817, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.785559792680892, "BMI": -0.10128721290095975, "Age": 2.44411648258522, "y_predict": 0, "y": 1}, {"Glucose": 1.660314890535021, "BMI": 1.618321182092413, "Age": -0.7749361147462792, "y_predict": 0, "y": 1}, {"Glucose": -0.7452616285638335, "BMI": 0.6227584270962495, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": -0.9416973307548637, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": -1.1356381271826876, "Age": -0.07892474235027935, "y_predict": 1, "y": 0}, {"Glucose": 0.7230772856913114, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": -0.5926038971847806, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.004528455311134083, "BMI": 0.29952376638320954, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 0.3383119256687749, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": -1.9949117683554463, "BMI": -1.3295789236105116, "Age": 2.96612501188222, "y_predict": 0, "y": 0}, {"Glucose": -2.0261530218502366, "BMI": -1.0063442628974717, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": 0.15730051566947267, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -0.825332852898169, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 1.879003664998553, "BMI": 1.4631685449501535, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 1.295086521379373, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 1.0354898206392145, "BMI": -0.34694555504286995, "Age": 0.5300852084962205, "y_predict": 0, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": -0.42452187361399973, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": 0.4106647507434082, "BMI": 0.4417470170969473, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": 1.7864032056631933, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": -0.5578141075950916, "BMI": 0.9201343149522468, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 0.5981122717121501, "BMI": 0.09265358352686469, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": -0.3391253331315594, "BMI": -0.46331003289956463, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.5020981921851291, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": -1.0063442628974717, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": 0.971851860666333, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -1.6398841978950298, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 0.053865424241299344, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": 0.45467640352546906, "Age": 0.18207952229822058, "y_predict": 0, "y": 1}, {"Glucose": -0.8077441355534142, "BMI": 0.5839702678106851, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 1.3479023555871177, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": 1.2541785951027467, "BMI": -0.20472230432913263, "Age": 1.2260965808922204, "y_predict": 0, "y": 1}, {"Glucose": -0.9014678960377851, "BMI": -0.049569667186873084, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.4731472577329888, "BMI": -0.7736153071840828, "Age": 1.5741022670902203, "y_predict": 0, "y": 0}, {"Glucose": 1.3166611020923273, "BMI": -0.049569667186873084, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": -1.0576741635117366, "BMI": 0.3383119256687749, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": 0.9589224742378113, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": -0.9014678960377851, "BMI": -1.6140254250379866, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": 0.053865424241299344, "Age": 2.61811932568422, "y_predict": 0, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": -0.2693692364717406, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": -1.6269548114665084, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": 0.37710008495433933, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 1.7088268870920647, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 0.11851235638390734, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": -0.8770503986122556, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 1.8165211580089724, "BMI": 1.5666036363783267, "Age": -0.8619375362957792, "y_predict": 0, "y": 1}, {"Glucose": -0.6827791215742529, "BMI": 0.5968996542392069, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.5451821085251206, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 1.0354898206392145, "BMI": 1.8251913649487588, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": 1.6290736370402306, "BMI": 0.8296286099525952, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": -0.12043655866802719, "BMI": 0.15730051566947267, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": 1.3338746806649375, "Age": 1.3130980024417203, "y_predict": 0, "y": 1}, {"Glucose": 1.8165211580089724, "BMI": 0.09265358352686469, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": 1.0667310741340048, "BMI": 0.8684167692381606, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": 0.17022990209799355, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": -1.213214445753817, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": -0.9804854900404286, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": 0.8942755420952032, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": 0.3641706985258175, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": 0.17022990209799355, "Age": 0.7040880515952205, "y_predict": 1, "y": 0}, {"Glucose": -0.3703665866263497, "BMI": -0.4503806464710428, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": 0.7908404506670308, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.589055361089882, "BMI": -0.15300475861504598, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": 1.5795330228068485, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.540886351470694, "Age": 2.87912359033272, "y_predict": 0, "y": 0}, {"Glucose": 1.0979723276287952, "BMI": 0.29952376638320954, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": -0.30815739575730505, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": -0.010781507901308654, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": 0.9589224742378113, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 1.0667310741340048, "BMI": 0.2607356070976451, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": -0.6202966145846722, "BMI": 0.48053517638251264, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": 0.37710008495433933, "Age": 2.00910937483772, "y_predict": 0, "y": 1}, {"Glucose": -1.2451216844804787, "BMI": -0.696038988612953, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": -0.7736153071840828, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": -0.7218977614699966, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": -0.6827791215742529, "BMI": -1.1356381271826876, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.7227973975246016, "BMI": 0.22194744781208067, "Age": 2.18311221793672, "y_predict": 0, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": -1.3037201507534686, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": -1.5262929659335915, "BMI": -0.049569667186873084, "Age": 0.4430837869467205, "y_predict": 1, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 0.9201343149522468, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": 1.285419848597537, "BMI": 0.7391229049529446, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": -0.9327091495325754, "BMI": -0.8770503986122556, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.540886351470694, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 2.378863720915198, "BMI": -0.19179291790061084, "Age": 1.7481051101892202, "y_predict": 0, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": 0.7391229049529446, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": 0.5356297647225695, "BMI": 0.15730051566947267, "Age": 0.18207952229822058, "y_predict": 0, "y": 0}, {"Glucose": -0.9327091495325754, "BMI": 1.0235694063804193, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -1.088915417006527, "BMI": 0.4934645628110335, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": 2.704389642088227, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": -0.8702266425429948, "BMI": -1.2261438321823388, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": 1.8381207513772806, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": 0.5322527220965989, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": 0.015077264955734913, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": -0.16593414504356774, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.5356297647225695, "BMI": 0.3383119256687749, "Age": -1.035940379394779, "y_predict": 1, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": 0.7003347456673793, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 0.06679481066982113, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 0.4731472577329888, "BMI": -4.135255778599698, "Age": 3.1401278549812197, "y_predict": 0, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -0.5926038971847806, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.825332852898169, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.19179291790061084, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": -1.9949117683554463, "BMI": 0.10558296995538555, "Age": 0.7040880515952205, "y_predict": 1, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": 0.0021478785272131297, "Age": 1.1390951593427203, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 1.1916514299512007, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": 0.9417660601548435, "BMI": 1.3080159078078948, "Age": -1.035940379394779, "y_predict": 0, "y": 1}, {"Glucose": -0.6827791215742529, "BMI": -1.31664953718199, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": -0.566745124327737, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": 1.1292135811235855, "BMI": -0.825332852898169, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 1.879003664998553, "BMI": -0.24351046361469705, "Age": 2.35711506103572, "y_predict": 0, "y": 1}, {"Glucose": 0.34818224375382756, "BMI": -0.6701802157559099, "Age": 3.1401278549812197, "y_predict": 0, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.31664953718199, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": 0.053865424241299344, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": -0.46409034711072067, "BMI": -0.38573371432843484, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -1.1744262864682526, "Age": -0.8619375362957792, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": -0.8641210121837339, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 1.101145724951549, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": -0.8077441355534142, "BMI": 0.0021478785272131297, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": 0.20901806138355888, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.4950517124388012, "BMI": -0.6701802157559099, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.6055332836133019, "Age": -0.07892474235027935, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -1.7821074486087676, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -0.10128721290095975, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": 1.6290736370402306, "BMI": 0.48053517638251264, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": 0.04093603781277756, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": -0.5279569650421726, "Age": 2.53111790413472, "y_predict": 0, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": 0.3900294713828611, "Age": 0.18207952229822058, "y_predict": 0, "y": 1}, {"Glucose": -0.30788407963676906, "BMI": -1.0322030357545149, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.0709911950400797, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.9029091714692988, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": 0.7520522913814655, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": -0.46331003289956463, "Age": 0.0950781007487206, "y_predict": 1, "y": 1}, {"Glucose": 1.7227973975246016, "BMI": 0.17022990209799355, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": 1.472867369566279, "BMI": 0.3900294713828611, "Age": 1.6611036886397201, "y_predict": 0, "y": 1}, {"Glucose": -1.682499233407543, "BMI": 1.7217562735205854, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": 0.04093603781277756, "Age": 0.18207952229822058, "y_predict": 1, "y": 1}, {"Glucose": 1.0042485671444241, "BMI": 1.1140751113800709, "Age": 0.5300852084962205, "y_predict": 0, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.9029091714692988, "Age": 2.7051207472337198, "y_predict": 0, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 1.036498792808941, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": -0.7865446936126046, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -1.182639177490898, "BMI": 0.028006651384256696, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.3391253331315594, "BMI": -0.7736153071840828, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.10128721290095975, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.3076041914700591, "BMI": -0.8511916257552126, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.379143609081908, "BMI": 0.20901806138355888, "Age": 1.4000994239912203, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 0.37710008495433933, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.3900294713828611, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.14007537218652463, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 1.9102449184933434, "BMI": -0.19179291790061084, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -0.589055361089882, "BMI": 0.48053517638251264, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 0.5981122717121501, "BMI": -1.019273649325993, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": 0.42881763066842554, "Age": 1.3130980024417203, "y_predict": 0, "y": 0}, {"Glucose": 2.2538987069360368, "BMI": -0.7865446936126046, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": 0.3794234972486179, "BMI": 0.053865424241299344, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -0.7140203750690433, "BMI": -0.8770503986122556, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -0.9934148764689499, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -1.083920581468601, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": -0.24351046361469705, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.5926038971847806, "Age": 0.0950781007487206, "y_predict": 1, "y": 1}, {"Glucose": -0.05795405167844655, "BMI": 0.8813461556666815, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -1.0968499678971229, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.4325692054492205, "BMI": 0.17022990209799355, "Age": 0.4430837869467205, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": 0.0021478785272131297, "Age": 0.5300852084962205, "y_predict": 0, "y": 0}, {"Glucose": 1.1604548346183758, "BMI": -0.10128721290095975, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 0.8425579963811171, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": 0.19197597627987598, "BMI": 0.907204928523725, "Age": 1.5741022670902203, "y_predict": 0, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 0.23487683424060155, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": 0.7908404506670308, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": -0.08919530517323687, "BMI": 1.4114509992360673, "Age": -1.035940379394779, "y_predict": 1, "y": 1}, {"Glucose": -0.3391253331315594, "BMI": 0.053865424241299344, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.5668710182173597, "BMI": -0.825332852898169, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": 1.3166611020923273, "BMI": 1.1528632706656352, "Age": 1.2260965808922204, "y_predict": 0, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.049569667186873084, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": -1.0322030357545149, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.9589224742378113, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": -0.589055361089882, "BMI": -0.15300475861504598, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": 1.285419848597537, "BMI": -0.5538157378992157, "Age": 1.83510653173872, "y_predict": 0, "y": 0}, {"Glucose": 0.06701096230071471, "BMI": 0.2736649935261669, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 0.879283553165263, "BMI": -0.34694555504286995, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": 0.24780622066912333, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.6572508293273885, "Age": -0.07892474235027935, "y_predict": 1, "y": 0}, {"Glucose": -0.9327091495325754, "BMI": -0.3598749414713917, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": -0.24351046361469705, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -1.445943401467206, "Age": 1.3130980024417203, "y_predict": 0, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": -0.2693692364717406, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": 1.0979723276287952, "BMI": -0.9287679443263419, "Age": 1.7481051101892202, "y_predict": 0, "y": 1}, {"Glucose": 2.347622467420408, "BMI": 0.7132641320959011, "Age": 2.09611079638722, "y_predict": 0, "y": 1}, {"Glucose": 0.31694099025903727, "BMI": -1.0709911950400797, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.31694099025903727, "BMI": 0.29952376638320954, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": -0.026712798183656235, "BMI": -0.6701802157559099, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -0.25643985004321884, "Age": -0.07892474235027935, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": 1.4373097720931107, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 0.8168010461756823, "BMI": -0.32108678218582687, "Age": 1.4871008455407202, "y_predict": 0, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": -0.47623941932808594, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": 1.472867369566279, "BMI": 0.8037698370955526, "Age": 0.6170866300457205, "y_predict": 0, "y": 1}, {"Glucose": 2.066451185967295, "BMI": 1.5019567042357187, "Age": 1.7481051101892202, "y_predict": 0, "y": 1}, {"Glucose": -0.8702266425429948, "BMI": -0.42452187361399973, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -0.7140203750690433, "BMI": 0.35124131209729664, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": -0.3986631007569566, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": -3.775663217558494, "BMI": 0.907204928523725, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": -1.5575342194283817, "BMI": -0.5150275786136508, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": -0.9287679443263419, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.24540157264718845, "BMI": -0.12714598575800287, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.407155242181641, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -1.1356381271826876, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.004528455311134083, "BMI": 0.5193233356680771, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.6605947787017308, "BMI": 1.553674249949805, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 2.2851399604308273, "BMI": -0.7606859207555611, "Age": 2.96612501188222, "y_predict": 0, "y": 0}, {"Glucose": 1.0979723276287952, "BMI": 2.109637866376233, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": -0.7765028820586238, "BMI": -1.445943401467206, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -1.182639177490898, "BMI": -1.7821074486087676, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 1.4103848625766984, "BMI": 1.7734738192346726, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 0.34818224375382756, "BMI": 0.3124531528117313, "Age": 0.9650923162437204, "y_predict": 0, "y": 1}, {"Glucose": 2.3163812139256175, "BMI": -0.889979785040777, "Age": 1.9221079532882202, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": -0.10128721290095975, "Age": -0.33992900699877926, "y_predict": 1, "y": 0}, {"Glucose": -2.4010480637877203, "BMI": -0.9029091714692988, "Age": 0.2690809438477206, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": 0.15730051566947267, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.8165211580089724, "BMI": 0.7520522913814655, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": -0.12043655866802719, "BMI": 0.3253825392402531, "Age": 0.6170866300457205, "y_predict": 0, "y": 1}, {"Glucose": -1.2451216844804787, "BMI": 1.8510501378058013, "Age": -0.07892474235027935, "y_predict": 1, "y": 0}, {"Glucose": -1.6512579799127527, "BMI": -0.9029091714692988, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": 0.10558296995538555, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": 1.4103848625766984, "BMI": -0.7994740800411259, "Age": 1.5741022670902203, "y_predict": 0, "y": 1}, {"Glucose": -0.6827791215742529, "BMI": -0.954626717183385, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.8477624115037627, "BMI": 0.2607356070976451, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.10558296995538555, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": -0.8702266425429948, "BMI": 1.4760979313786753, "Age": 0.18207952229822058, "y_predict": 1, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 0.0021478785272131297, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": 0.4934645628110335, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": -1.0264329100169465, "BMI": -0.9804854900404286, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": -0.10128721290095975, "Age": 0.9650923162437204, "y_predict": 0, "y": 1}, {"Glucose": 0.9417660601548435, "BMI": 0.45467640352546906, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": -0.5150275786136508, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -1.5575342194283817, "BMI": -1.31664953718199, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 1.6915561440298112, "BMI": 0.20901806138355888, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": 0.004528455311134083, "BMI": -0.7477565343270397, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": 0.785559792680892, "BMI": -0.5796745107562589, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": 0.5356297647225695, "BMI": 1.049428179237463, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 0.6744759728103367, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": -0.8382622393266908, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -1.0063442628974717, "Age": 1.9221079532882202, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 0.22194744781208067, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": -0.42452187361399973, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -0.7606859207555611, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.049569667186873084, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": -0.696038988612953, "Age": -0.16592616389977932, "y_predict": 1, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": -1.148567513611209, "Age": 2.00910937483772, "y_predict": 0, "y": 0}, {"Glucose": 2.4101049744099883, "BMI": 1.2045808163797214, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": -0.24540157264718845, "BMI": -1.2390732186108606, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -1.0451324221830365, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -0.566745124327737, "Age": 1.0520937377932202, "y_predict": 0, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": -0.20472230432913263, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 1.879003664998553, "BMI": 0.2736649935261669, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.7520522913814655, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": -0.566745124327737, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.0021478785272131297, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": 1.785279904514182, "BMI": 1.0235694063804193, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": -0.9327091495325754, "BMI": 0.053865424241299344, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": 0.8425579963811171, "Age": 1.4000994239912203, "y_predict": 0, "y": 0}, {"Glucose": -0.9327091495325754, "BMI": 0.1443711292409509, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 2.1289336929568754, "BMI": -0.24351046361469705, "Age": 2.27011363948622, "y_predict": 0, "y": 1}, {"Glucose": -0.27664282614197877, "BMI": 0.2736649935261669, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.631392056470345, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 1.4631685449501535, "Age": 1.0520937377932202, "y_predict": 0, "y": 1}, {"Glucose": -1.5575342194283817, "BMI": 0.15730051566947267, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": 0.8480422996704726, "BMI": 0.06679481066982113, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 1.5353498765558595, "BMI": 1.553674249949805, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": 1.4416261160714887, "BMI": -1.1097793543256445, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 1.5795330228068485, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": -0.10128721290095975, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": -0.7765028820586238, "BMI": 0.6874053592388575, "Age": 0.6170866300457205, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -0.631392056470345, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": -0.6827791215742529, "BMI": 0.8554873828096389, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": 0.7261935185244228, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": -1.148567513611209, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": 0.5668710182173597, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": 1.618321182092413, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -0.6055332836133019, "Age": 2.27011363948622, "y_predict": 0, "y": 0}, {"Glucose": 1.285419848597537, "BMI": 2.2777198899470146, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": -1.1513979239961076, "BMI": -0.29522800932878374, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": 0.785559792680892, "BMI": 1.101145724951549, "Age": 0.9650923162437204, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.3986631007569566, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": 0.23487683424060155, "Age": 1.83510653173872, "y_predict": 0, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": -0.9804854900404286, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.4417470170969473, "Age": 1.4871008455407202, "y_predict": 0, "y": 0}, {"Glucose": -0.24540157264718845, "BMI": -0.32108678218582687, "Age": -0.6879346931967791, "y_predict": 1, "y": 0}, {"Glucose": 0.4106647507434082, "BMI": -0.7865446936126046, "Age": 4.18414491357522, "y_predict": 0, "y": 0}, {"Glucose": 0.9417660601548435, "BMI": -0.29522800932878374, "Age": 0.2690809438477206, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.7089683750414748, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.1443711292409509, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -1.2520026050393818, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.691836032196521, "BMI": -0.7477565343270397, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": 0.19608867495503712, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.35124131209729664, "Age": 0.008076679199220628, "y_predict": 1, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": -0.19179291790061084, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 2.441346227904779, "BMI": 1.4114509992360673, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 1.6290736370402306, "BMI": -0.29522800932878374, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 0.7649816778099873, "Age": 0.6170866300457205, "y_predict": 0, "y": 1}, {"Glucose": 0.0357697088059244, "BMI": 2.2906492763755364, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": -1.1513979239961076, "BMI": 0.4934645628110335, "Age": -1.035940379394779, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.8425579963811171, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 0.8480422996704726, "BMI": 0.7261935185244228, "Age": 1.5741022670902203, "y_predict": 0, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": -1.148567513611209, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": 0.28659437995468867, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": -1.4638104589440109, "BMI": -0.540886351470694, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": 0.28659437995468867, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": 0.5356297647225695, "BMI": 0.5322527220965989, "Age": 1.4871008455407202, "y_predict": 0, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": 0.9459930878092895, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.5063939492395553, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": 0.5668710182173597, "BMI": -0.43745126004252105, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.2390732186108606, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": 1.7605444328061508, "Age": 0.4430837869467205, "y_predict": 0, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": 1.3468040670934591, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -1.2261438321823388, "Age": -1.035940379394779, "y_predict": 1, "y": 0}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Based on the plot, we can say the class 1 in <strong>y_predict</strong> is more likely to be the class 0 in <strong>y</strong>.</p>
<p>Then we can calculate the training accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_train_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X_train_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_train_scaled_kmeans</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training accuracy 0.754071661237785
</pre></div>
</div>
</div>
</div>
<p>We need to test the model to check whether it overfit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_scaled_kmeans</span> <span class="o">=</span> <span class="n">X_test_scaled</span><span class="p">[</span><span class="n">kmeans_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">kmeans_result</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled_kmeans</span><span class="p">)</span>
<span class="n">X_test_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_result</span>
<span class="n">X_test_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_test_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X_test_scaled_kmeans</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_test_scaled_kmeans</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test accuracy 0.6948051948051948
</pre></div>
</div>
</div>
</div>
<p>It seems the model is overfitting a bit. I think one possible reason is that there are much more “negative” than “positive” in the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    401
1    213
Name: Outcome, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Note that there are 65% class 0 in the training data, much more than 50%. The idea comes to my mind is to sample 213 rows of class 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">training_data</span> <span class="o">=</span> <span class="n">X_train_scaled</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">training_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<span class="n">training_data_class0</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="n">training_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">training_data_class1</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="n">training_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">training_data_class0_sample</span> <span class="o">=</span> <span class="n">training_data_class0</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">213</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we have 213 class 0 and 213 class 1, we will concatnate them together to create the new training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_scaled_balanced</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">training_data_class0_sample</span><span class="p">,</span> <span class="n">training_data_class1</span><span class="p">])</span>
<span class="n">y_train_balanced</span> <span class="o">=</span> <span class="n">X_train_scaled_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">X_train_scaled_balanced</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s fit a kmeans model on the balanced data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_scaled_kmeans_balanced</span> <span class="o">=</span> <span class="n">X_train_scaled_balanced</span><span class="p">[</span><span class="n">kmeans_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">kmeans_balanced</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kmeans_balanced</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled_kmeans_balanced</span><span class="p">)</span>
<span class="n">X_train_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_balanced</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled_kmeans_balanced</span><span class="p">)</span>
<span class="n">X_train_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_train_balanced</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Similar to before, we will plot the prediction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_kmeans_balanced</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y:N&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_kmeans_balanced</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y_predict:N&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">,</span><span class="s2">&quot;Glucose&quot;</span><span class="p">,</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-9fcbf028223e461f9b282d54e4d1e0ba"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9fcbf028223e461f9b282d54e4d1e0ba") {
      outputDiv = document.getElementById("altair-viz-9fcbf028223e461f9b282d54e4d1e0ba");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"mark": "circle", "encoding": {"color": {"field": "y", "type": "nominal"}, "tooltip": [{"field": "y", "type": "quantitative"}, {"field": "Glucose", "type": "quantitative"}, {"field": "BMI", "type": "quantitative"}, {"field": "Age", "type": "quantitative"}], "x": {"field": "Glucose", "type": "quantitative"}, "y": {"field": "BMI", "type": "quantitative"}}}, {"mark": "circle", "encoding": {"color": {"field": "y_predict", "type": "nominal"}, "tooltip": [{"field": "y_predict", "type": "quantitative"}, {"field": "Glucose", "type": "quantitative"}, {"field": "BMI", "type": "quantitative"}, {"field": "Age", "type": "quantitative"}], "x": {"field": "Glucose", "type": "quantitative"}, "y": {"field": "BMI", "type": "quantitative"}}}], "data": {"name": "data-9f6357b828dc28a83a89d261e3f43a4b"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-9f6357b828dc28a83a89d261e3f43a4b": [{"Glucose": 0.2232172297746663, "BMI": 1.036498792808941, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.9029091714692988, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": -0.049569667186873084, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -1.6398841978950298, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": -1.5493784928953787, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": 0.9847812470948548, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.35124131209729664, "Age": 0.008076679199220628, "y_predict": 0, "y": 0}, {"Glucose": 0.691836032196521, "BMI": 1.682968114235021, "Age": 1.2260965808922204, "y_predict": 1, "y": 0}, {"Glucose": 1.0354898206392145, "BMI": 1.8251913649487588, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -1.3388454449648495, "BMI": 0.22194744781208067, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 2.191416199946456, "BMI": -0.14007537218652463, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -0.566745124327737, "Age": 1.0520937377932202, "y_predict": 1, "y": 0}, {"Glucose": -1.2138804309856883, "BMI": -0.4503806464710428, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -1.3388454449648495, "BMI": 0.06679481066982113, "Age": 0.5300852084962205, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.9158385578978205, "Age": 2.09611079638722, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -0.10128721290095975, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": 1.8381207513772806, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -1.7821074486087676, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.8389853890482045, "BMI": 0.17022990209799355, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.5020981921851291, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -1.083920581468601, "Age": 0.9650923162437204, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.25643985004321884, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.8425579963811171, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -1.5575342194283817, "BMI": -1.31664953718199, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": -4.135255778599698, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": 0.5063939492395553, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": -0.8770503986122556, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": -0.2693692364717406, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.3986631007569566, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -1.4950517124388012, "BMI": -1.407155242181641, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": 0.9459930878092895, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": 1.9414861719881338, "BMI": 1.1399338842371134, "Age": 1.0520937377932202, "y_predict": 1, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -0.5926038971847806, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": -1.407155242181641, "Age": 1.9221079532882202, "y_predict": 1, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -1.1356381271826876, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.6293535252069404, "BMI": -0.566745124327737, "Age": 0.6170866300457205, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -1.4976609471812925, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.2390732186108606, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -1.2138804309856883, "BMI": -1.407155242181641, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.34818224375382756, "BMI": -0.5150275786136508, "Age": 2.61811932568422, "y_predict": 1, "y": 0}, {"Glucose": 2.2851399604308273, "BMI": -0.7606859207555611, "Age": 2.96612501188222, "y_predict": 1, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": 1.4631685449501535, "Age": 0.008076679199220628, "y_predict": 0, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": -1.31664953718199, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -1.8699467543762849, "BMI": 0.3124531528117313, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": 0.6227584270962495, "Age": -0.16592616389977932, "y_predict": 0, "y": 0}, {"Glucose": -0.24540157264718845, "BMI": -0.32108678218582687, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.785559792680892, "BMI": -0.29522800932878374, "Age": -0.33992900699877926, "y_predict": 0, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -0.6184626700418238, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.06701096230071471, "BMI": 0.20901806138355888, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": 0.5668710182173597, "BMI": -0.631392056470345, "Age": 2.09611079638722, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.19179291790061084, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": 0.5981122717121501, "BMI": -1.019273649325993, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.9417660601548435, "BMI": 0.45467640352546906, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": -0.4115924871854779, "Age": 2.44411648258522, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": 0.28659437995468867, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.954626717183385, "Age": -0.16592616389977932, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -0.540886351470694, "Age": 2.87912359033272, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.0021478785272131297, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 0.3253825392402531, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": 0.7230772856913114, "BMI": -0.32108678218582687, "Age": 0.35608236539722055, "y_predict": 1, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.8770503986122556, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -1.088915417006527, "BMI": 0.4934645628110335, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -1.682499233407543, "BMI": 1.7217562735205854, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.29522800932878374, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.24351046361469705, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": 0.19197597627987598, "BMI": -0.5538157378992157, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": 0.20901806138355888, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.3703665866263497, "BMI": -0.8770503986122556, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.3703665866263497, "BMI": -0.4503806464710428, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.8511916257552126, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -1.182639177490898, "BMI": 0.028006651384256696, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 1.0354898206392145, "BMI": 0.10558296995538555, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -1.276362937975269, "BMI": -1.665742970752073, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.0063442628974717, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.995191656522156, "BMI": 0.19608867495503712, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 0.9201343149522468, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": -1.213214445753817, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.631392056470345, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": 1.3855922263790246, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.38573371432843484, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": -0.7865446936126046, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.8684167692381606, "Age": 0.7910894731447204, "y_predict": 1, "y": 0}, {"Glucose": -2.0261530218502366, "BMI": -1.0063442628974717, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.5356297647225695, "BMI": 1.049428179237463, "Age": -0.42693042854827923, "y_predict": 1, "y": 0}, {"Glucose": -1.4950517124388012, "BMI": -0.6701802157559099, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": 1.379143609081908, "BMI": 2.0579203206621473, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.540886351470694, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -1.083920581468601, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.24351046361469705, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.19197597627987598, "BMI": 0.3124531528117313, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": 0.7908404506670308, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -1.182639177490898, "BMI": -1.7821074486087676, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.2607356070976451, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": -0.42452187361399973, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": 0.2232172297746663, "BMI": 0.29952376638320954, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.21416031915239814, "BMI": -1.3037201507534686, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.8554873828096389, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": 0.16073472278508566, "BMI": -0.16593414504356774, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.0709911950400797, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": -0.10128721290095975, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.9327091495325754, "BMI": -0.8770503986122556, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.004528455311134083, "BMI": 0.907204928523725, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": 0.7543185391861017, "BMI": -1.2649319914679036, "Age": 2.09611079638722, "y_predict": 1, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.9589224742378113, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 1.230439589236765, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -1.0264329100169465, "BMI": -0.38573371432843484, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.15300475861504598, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.28659437995468867, "Age": 1.6611036886397201, "y_predict": 1, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -0.7606859207555611, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.004528455311134083, "BMI": -0.7477565343270397, "Age": -0.2529275854492793, "y_predict": 0, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": -0.9675561036119068, "Age": 0.2690809438477206, "y_predict": 0, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": 0.971851860666333, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.785559792680892, "BMI": 1.101145724951549, "Age": 0.9650923162437204, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -1.2520026050393818, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": 2.2538987069360368, "BMI": -0.7865446936126046, "Age": -0.7749361147462792, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.7477565343270397, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.09825221579550503, "BMI": 0.4417470170969473, "Age": 0.0950781007487206, "y_predict": 1, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": -0.7865446936126046, "Age": -0.16592616389977932, "y_predict": 0, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": -0.696038988612953, "Age": -0.16592616389977932, "y_predict": 0, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": -0.9804854900404286, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": 0.9105248066600533, "BMI": -1.4200846286101627, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": -0.7452616285638335, "BMI": -1.7821074486087676, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": 0.9730073136496339, "BMI": 1.230439589236765, "Age": -0.5139318500977792, "y_predict": 1, "y": 0}, {"Glucose": -1.9949117683554463, "BMI": 0.10558296995538555, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 0.40295885781138285, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": 0.9977106335233766, "Age": -0.33992900699877926, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": 0.6744759728103367, "Age": 1.0520937377932202, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -0.6055332836133019, "Age": 2.27011363948622, "y_predict": 1, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 1, "y": 0}, {"Glucose": -1.5262929659335915, "BMI": -0.049569667186873084, "Age": 0.4430837869467205, "y_predict": 0, "y": 0}, {"Glucose": -0.3391253331315594, "BMI": 0.053865424241299344, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -0.9287679443263419, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -1.0451324221830365, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -1.0322030357545149, "Age": 0.18207952229822058, "y_predict": 0, "y": 0}, {"Glucose": 1.0042485671444241, "BMI": 1.1140751113800709, "Age": -0.8619375362957792, "y_predict": 1, "y": 0}, {"Glucose": -1.7449817403971237, "BMI": 0.0021478785272131297, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -1.6512579799127527, "BMI": -0.9029091714692988, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": 0.0021478785272131297, "Age": 1.1390951593427203, "y_predict": 0, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": -1.6269548114665084, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.4417470170969473, "Age": 1.4871008455407202, "y_predict": 1, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": 0.15730051566947267, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -0.282298622900262, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.49533160060551096, "BMI": 0.37710008495433933, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": 0.6293535252069404, "BMI": 0.053865424241299344, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.08919530517323687, "BMI": 0.17022990209799355, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.6605947787017308, "BMI": -0.9416973307548637, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -0.954626717183385, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.40160784012114004, "BMI": -0.7736153071840828, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -0.9639504030273658, "BMI": -0.6184626700418238, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": 0.7520522913814655, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -1.0576741635117366, "BMI": 0.6744759728103367, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.995191656522156, "BMI": -0.10128721290095975, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.08919530517323687, "BMI": 1.618321182092413, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.8702266425429948, "BMI": -0.20472230432913263, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 1.1916960881131662, "BMI": -0.5926038971847806, "Age": 0.6170866300457205, "y_predict": 1, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": 0.7261935185244228, "Age": 1.5741022670902203, "y_predict": 1, "y": 0}, {"Glucose": -0.6515378680794626, "BMI": -0.8641210121837339, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": -1.3076041914700591, "BMI": 0.0021478785272131297, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.691836032196521, "BMI": -0.24351046361469705, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.7765028820586238, "BMI": -1.445943401467206, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": 0.2856997367642469, "BMI": -1.148567513611209, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.9014678960377851, "BMI": -1.0063442628974717, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": 0.12949346929029534, "BMI": -0.25643985004321884, "Age": -0.07892474235027935, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.971851860666333, "Age": 0.4430837869467205, "y_predict": 1, "y": 0}, {"Glucose": 0.5043885112277792, "BMI": -1.0063442628974717, "Age": 1.9221079532882202, "y_predict": 1, "y": 0}, {"Glucose": 0.4106647507434082, "BMI": -0.7218977614699966, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": -0.8770503986122556, "Age": 0.35608236539722055, "y_predict": 0, "y": 0}, {"Glucose": 0.5981122717121501, "BMI": 0.7003347456673793, "Age": 0.7040880515952205, "y_predict": 1, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": 1.7217562735205854, "Age": -0.6009332716472792, "y_predict": 1, "y": 0}, {"Glucose": -1.1201566705013173, "BMI": -0.9804854900404286, "Age": 0.7910894731447204, "y_predict": 0, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.30815739575730505, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": -0.18291906565760782, "BMI": -1.0322030357545149, "Age": 0.0950781007487206, "y_predict": 0, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -1.601096038609465, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -1.4013279519544302, "BMI": 0.10558296995538555, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": -0.589055361089882, "BMI": -0.889979785040777, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.05795405167844655, "BMI": 0.8813461556666815, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -1.088915417006527, "BMI": 1.2045808163797214, "Age": -0.33992900699877926, "y_predict": 0, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": 0.3641706985258175, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.0063442628974717, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.7994740800411259, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.7132641320959011, "Age": -0.6009332716472792, "y_predict": 0, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -0.7218977614699966, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -0.5265728541003013, "BMI": -0.540886351470694, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": -1.5575342194283817, "BMI": -0.5150275786136508, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.1516778121628175, "BMI": -0.7348271478985179, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -3.775663217558494, "BMI": -0.5538157378992157, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": -1.0322030357545149, "Age": 0.008076679199220628, "y_predict": 0, "y": 0}, {"Glucose": -1.3076041914700591, "BMI": -0.8511916257552126, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": 0.37710008495433933, "Age": -0.2529275854492793, "y_predict": 1, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": -0.6572508293273885, "Age": -0.07892474235027935, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -1.213214445753817, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": 0.28659437995468867, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -1.276362937975269, "BMI": -0.7477565343270397, "Age": 0.7040880515952205, "y_predict": 0, "y": 0}, {"Glucose": -0.46409034711072067, "BMI": -0.14007537218652463, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": -0.4328490936159303, "BMI": -0.15300475861504598, "Age": -0.7749361147462792, "y_predict": 0, "y": 0}, {"Glucose": 0.25445848326945664, "BMI": -0.10128721290095975, "Age": -0.33992900699877926, "y_predict": 0, "y": 0}, {"Glucose": 0.8168010461756823, "BMI": -0.2693692364717406, "Age": -0.42693042854827923, "y_predict": 0, "y": 0}, {"Glucose": -2.4010480637877203, "BMI": -0.9029091714692988, "Age": 0.2690809438477206, "y_predict": 0, "y": 0}, {"Glucose": -1.9949117683554463, "BMI": -1.3295789236105116, "Age": 2.96612501188222, "y_predict": 0, "y": 0}, {"Glucose": -0.12043655866802719, "BMI": 0.23487683424060155, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.8702266425429948, "BMI": -0.42452187361399973, "Age": -0.8619375362957792, "y_predict": 0, "y": 0}, {"Glucose": 0.0357697088059244, "BMI": -1.1614969000397308, "Age": 0.6170866300457205, "y_predict": 0, "y": 0}, {"Glucose": -1.1513979239961076, "BMI": -0.010781507901308654, "Age": -0.6879346931967791, "y_predict": 0, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -0.9029091714692988, "Age": 2.7051207472337198, "y_predict": 1, "y": 0}, {"Glucose": -0.026712798183656235, "BMI": -1.445943401467206, "Age": 1.3130980024417203, "y_predict": 0, "y": 0}, {"Glucose": 1.0042485671444241, "BMI": 1.1140751113800709, "Age": 0.5300852084962205, "y_predict": 1, "y": 0}, {"Glucose": -1.2451216844804787, "BMI": -0.5796745107562589, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.30788407963676906, "BMI": -0.32108678218582687, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": 0.06701096230071471, "BMI": 3.273282644943177, "Age": -0.9489389578452792, "y_predict": 1, "y": 0}, {"Glucose": -0.6202966145846722, "BMI": -1.31664953718199, "Age": -0.9489389578452792, "y_predict": 0, "y": 0}, {"Glucose": -0.8077441355534142, "BMI": -0.7865446936126046, "Age": 0.2690809438477206, "y_predict": 0, "y": 0}, {"Glucose": -0.6827791215742529, "BMI": 0.5968996542392069, "Age": -1.035940379394779, "y_predict": 0, "y": 0}, {"Glucose": -0.5578141075950916, "BMI": -0.566745124327737, "Age": -0.5139318500977792, "y_predict": 0, "y": 0}, {"Glucose": -0.27664282614197877, "BMI": -0.4891688057566077, "Age": 1.4871008455407202, "y_predict": 1, "y": 1}, {"Glucose": 0.4106647507434082, "BMI": 1.8381207513772806, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": 0.34818224375382756, "BMI": 0.11851235638390734, "Age": -0.8619375362957792, "y_predict": 0, "y": 1}, {"Glucose": 1.2541785951027467, "BMI": -0.8382622393266908, "Age": 1.2260965808922204, "y_predict": 1, "y": 1}, {"Glucose": 1.5665911300506499, "BMI": 1.5019567042357187, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": 0.0357697088059244, "BMI": 0.17022990209799355, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.11851235638390734, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.0021478785272131297, "Age": 0.18207952229822058, "y_predict": 0, "y": 1}, {"Glucose": -0.5265728541003013, "BMI": -0.2693692364717406, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": 0.31694099025903727, "BMI": -0.049569667186873084, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": 0.8168010461756823, "BMI": 2.2389317306614496, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 1.4631685449501535, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 2.2851399604308273, "BMI": -1.0968499678971229, "Age": 2.27011363948622, "y_predict": 1, "y": 1}, {"Glucose": -1.3388454449648495, "BMI": -0.12714598575800287, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 1.0235694063804193, "Age": 0.9650923162437204, "y_predict": 1, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": 0.5968996542392069, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 1.5353498765558595, "BMI": 0.3253825392402531, "Age": -0.2529275854492793, "y_predict": 1, "y": 1}, {"Glucose": -0.7452616285638335, "BMI": 0.4676057899539909, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": 2.066451185967295, "BMI": 0.7391229049529446, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 0.9730073136496339, "BMI": -0.6701802157559099, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": 0.691836032196521, "BMI": 0.5968996542392069, "Age": 1.5741022670902203, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": -0.19179291790061084, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 1.5665911300506499, "BMI": 0.17022990209799355, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": -0.05795405167844655, "BMI": 0.053865424241299344, "Age": -0.7749361147462792, "y_predict": 0, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": 0.3641706985258175, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": 0.44190600423819854, "BMI": 1.3338746806649375, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": 0.0357697088059244, "BMI": 0.40295885781138285, "Age": -0.2529275854492793, "y_predict": 0, "y": 1}, {"Glucose": 0.5356297647225695, "BMI": 0.5581114949536415, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 0.3794234972486179, "BMI": 0.11851235638390734, "Age": 0.5300852084962205, "y_predict": 1, "y": 1}, {"Glucose": -0.8077441355534142, "BMI": 0.3900294713828611, "Age": 0.8780908946942204, "y_predict": 0, "y": 1}, {"Glucose": 0.691836032196521, "BMI": 0.37710008495433933, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 0.16073472278508566, "BMI": -0.24351046361469705, "Age": 1.2260965808922204, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 0.5839702678106851, "Age": 0.35608236539722055, "y_predict": 1, "y": 1}, {"Glucose": 1.2229373416079565, "BMI": -0.19179291790061084, "Age": 0.5300852084962205, "y_predict": 1, "y": 1}, {"Glucose": 1.285419848597537, "BMI": -0.9934148764689499, "Age": 1.4871008455407202, "y_predict": 1, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": 0.8425579963811171, "Age": 0.35608236539722055, "y_predict": 1, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 0.5839702678106851, "Age": 0.18207952229822058, "y_predict": 1, "y": 1}, {"Glucose": 1.472867369566279, "BMI": 0.7779110642385091, "Age": 0.0950781007487206, "y_predict": 1, "y": 1}, {"Glucose": 1.5665911300506499, "BMI": 1.7346856599491072, "Age": 1.83510653173872, "y_predict": 1, "y": 1}, {"Glucose": 2.3163812139256175, "BMI": -0.14007537218652463, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 0.06679481066982113, "Age": 3.22712927653072, "y_predict": 1, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 4.540362514938294, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 0.5710408813821632, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": 2.1289336929568754, "BMI": 0.29952376638320954, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": -0.25643985004321884, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": 0.0021478785272131297, "Age": 2.18311221793672, "y_predict": 1, "y": 1}, {"Glucose": 2.1289336929568754, "BMI": -0.10128721290095975, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -4.135255778599698, "Age": 1.83510653173872, "y_predict": 0, "y": 1}, {"Glucose": 2.347622467420408, "BMI": 1.0106400199518975, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": -0.049569667186873084, "Age": 2.87912359033272, "y_predict": 1, "y": 1}, {"Glucose": 0.9417660601548435, "BMI": 1.4114509992360673, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": 0.4106647507434082, "BMI": -1.0580618086115579, "Age": 2.35711506103572, "y_predict": 1, "y": 1}, {"Glucose": 0.3794234972486179, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 1.4631685449501535, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": -0.6443214428988668, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": 0.6605947787017308, "BMI": -0.20472230432913263, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": -0.5279569650421726, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 1.879003664998553, "BMI": 0.5063939492395553, "Age": 1.5741022670902203, "y_predict": 1, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": 0.6615465863818148, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -1.0264329100169465, "BMI": 2.9759067570871807, "Age": -0.6009332716472792, "y_predict": 0, "y": 1}, {"Glucose": 1.3479023555871177, "BMI": -0.15300475861504598, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": 0.8480422996704726, "BMI": 0.20901806138355888, "Age": 1.4871008455407202, "y_predict": 1, "y": 1}, {"Glucose": 2.160174946451666, "BMI": 0.45467640352546906, "Age": 2.87912359033272, "y_predict": 1, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": 0.2607356070976451, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 2.0352099324725046, "BMI": 0.3253825392402531, "Age": 0.35608236539722055, "y_predict": 1, "y": 1}, {"Glucose": 1.6290736370402306, "BMI": 0.6227584270962495, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 1.5041086230610692, "BMI": -0.2693692364717406, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": -3.775663217558494, "BMI": 1.165792657094157, "Age": 0.35608236539722055, "y_predict": 0, "y": 1}, {"Glucose": 2.0976924394620853, "BMI": 0.0021478785272131297, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": -0.25643985004321884, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": 0.9589224742378113, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": -0.18291906565760782, "BMI": 0.22194744781208067, "Age": 0.6170866300457205, "y_predict": 1, "y": 1}, {"Glucose": 1.3166611020923273, "BMI": 0.907204928523725, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 3.5447997599421313, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": 1.8251913649487588, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": 0.9201343149522468, "Age": 0.35608236539722055, "y_predict": 1, "y": 1}, {"Glucose": -0.12043655866802719, "BMI": -0.29522800932878374, "Age": -0.2529275854492793, "y_predict": 0, "y": 1}, {"Glucose": -0.589055361089882, "BMI": 0.971851860666333, "Age": 0.7910894731447204, "y_predict": 1, "y": 1}, {"Glucose": -0.24540157264718845, "BMI": 0.17022990209799355, "Age": -0.8619375362957792, "y_predict": 0, "y": 1}, {"Glucose": 1.660314890535021, "BMI": 0.11851235638390734, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": 2.2851399604308273, "BMI": 0.5063939492395553, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 0.06701096230071471, "BMI": 0.5581114949536415, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": -0.27664282614197877, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": -0.8702266425429948, "BMI": 0.7779110642385091, "Age": -0.8619375362957792, "y_predict": 0, "y": 1}, {"Glucose": 2.2538987069360368, "BMI": 0.37710008495433933, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.3986631007569566, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": -0.18291906565760782, "BMI": 0.3383119256687749, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": 1.0667310741340048, "BMI": -0.696038988612953, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 2.066451185967295, "BMI": 0.24780622066912333, "Age": 0.0950781007487206, "y_predict": 1, "y": 1}, {"Glucose": 2.378863720915198, "BMI": -0.7865446936126046, "Age": 0.5300852084962205, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.11421659932948107, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": 0.8037698370955526, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 1.9727274254829241, "BMI": -0.25643985004321884, "Age": 1.4000994239912203, "y_predict": 1, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.5968996542392069, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": -0.30788407963676906, "BMI": 1.9156970699484095, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 2.0976924394620853, "BMI": 2.0579203206621473, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -0.7452616285638335, "BMI": 1.1528632706656352, "Age": -0.07892474235027935, "y_predict": 0, "y": 1}, {"Glucose": -0.05795405167844655, "BMI": 1.7605444328061508, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": -0.566745124327737, "Age": 1.4000994239912203, "y_predict": 1, "y": 1}, {"Glucose": 2.347622467420408, "BMI": 0.5839702678106851, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": 0.785559792680892, "BMI": 0.7649816778099873, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": -0.30815739575730505, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": 0.28659437995468867, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": -0.5926038971847806, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": -0.24540157264718845, "BMI": 0.20901806138355888, "Age": -1.035940379394779, "y_predict": 0, "y": 1}, {"Glucose": 0.785559792680892, "BMI": -0.10128721290095975, "Age": 2.44411648258522, "y_predict": 1, "y": 1}, {"Glucose": 1.660314890535021, "BMI": 1.618321182092413, "Age": -0.7749361147462792, "y_predict": 1, "y": 1}, {"Glucose": 0.7230772856913114, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 0.004528455311134083, "BMI": 0.29952376638320954, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 1.879003664998553, "BMI": 1.4631685449501535, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": 1.8477624115037627, "BMI": 1.295086521379373, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": -0.42452187361399973, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": 0.4106647507434082, "BMI": 0.4417470170969473, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": 1.7864032056631933, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": -0.5578141075950916, "BMI": 0.9201343149522468, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 0.5981122717121501, "BMI": 0.09265358352686469, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 0.053865424241299344, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": 1.1604548346183758, "BMI": 0.45467640352546906, "Age": 0.18207952229822058, "y_predict": 1, "y": 1}, {"Glucose": 1.3479023555871177, "BMI": 0.10558296995538555, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 1.2541785951027467, "BMI": -0.20472230432913263, "Age": 1.2260965808922204, "y_predict": 1, "y": 1}, {"Glucose": 1.3166611020923273, "BMI": -0.049569667186873084, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": 0.8168010461756823, "BMI": 0.9589224742378113, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -0.589055361089882, "BMI": 0.11851235638390734, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": 1.8165211580089724, "BMI": 1.5666036363783267, "Age": -0.8619375362957792, "y_predict": 1, "y": 1}, {"Glucose": 1.6290736370402306, "BMI": 0.8296286099525952, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": -0.026712798183656235, "BMI": 1.3338746806649375, "Age": 1.3130980024417203, "y_predict": 1, "y": 1}, {"Glucose": 1.8165211580089724, "BMI": 0.09265358352686469, "Age": 0.2690809438477206, "y_predict": 1, "y": 1}, {"Glucose": 1.0667310741340048, "BMI": 0.8684167692381606, "Age": -0.6879346931967791, "y_predict": 1, "y": 1}, {"Glucose": 1.0979723276287952, "BMI": 0.29952376638320954, "Age": 0.7910894731447204, "y_predict": 1, "y": 1}, {"Glucose": 1.0667310741340048, "BMI": 0.2607356070976451, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": -0.9639504030273658, "BMI": 0.37710008495433933, "Age": 2.00910937483772, "y_predict": 1, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": -0.7218977614699966, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": 1.7227973975246016, "BMI": 0.22194744781208067, "Age": 2.18311221793672, "y_predict": 1, "y": 1}, {"Glucose": 1.285419848597537, "BMI": 0.7391229049529446, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": 2.378863720915198, "BMI": -0.19179291790061084, "Age": 1.7481051101892202, "y_predict": 1, "y": 1}, {"Glucose": -0.18291906565760782, "BMI": 2.704389642088227, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": 0.5356297647225695, "BMI": 0.3383119256687749, "Age": -1.035940379394779, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 1.1916514299512007, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 0.9417660601548435, "BMI": 1.3080159078078948, "Age": -1.035940379394779, "y_predict": 1, "y": 1}, {"Glucose": 1.879003664998553, "BMI": -0.24351046361469705, "Age": 2.35711506103572, "y_predict": 1, "y": 1}, {"Glucose": -0.40160784012114004, "BMI": 0.053865424241299344, "Age": 0.7910894731447204, "y_predict": 0, "y": 1}, {"Glucose": -0.4328490936159303, "BMI": -1.1744262864682526, "Age": -0.8619375362957792, "y_predict": 0, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 1.101145724951549, "Age": -0.7749361147462792, "y_predict": 0, "y": 1}, {"Glucose": -0.8077441355534142, "BMI": 0.0021478785272131297, "Age": -0.16592616389977932, "y_predict": 0, "y": 1}, {"Glucose": 1.6290736370402306, "BMI": 0.48053517638251264, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": 0.04093603781277756, "Age": -0.5139318500977792, "y_predict": 0, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": -0.5279569650421726, "Age": 2.53111790413472, "y_predict": 1, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": 0.3900294713828611, "Age": 0.18207952229822058, "y_predict": 1, "y": 1}, {"Glucose": -0.27664282614197877, "BMI": 0.7520522913814655, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 0.2856997367642469, "BMI": -0.46331003289956463, "Age": 0.0950781007487206, "y_predict": 0, "y": 1}, {"Glucose": 1.7227973975246016, "BMI": 0.17022990209799355, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": 1.472867369566279, "BMI": 0.3900294713828611, "Age": 1.6611036886397201, "y_predict": 1, "y": 1}, {"Glucose": -0.1516778121628175, "BMI": 0.04093603781277756, "Age": 0.18207952229822058, "y_predict": 0, "y": 1}, {"Glucose": 1.9102449184933434, "BMI": -0.19179291790061084, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": -0.5926038971847806, "Age": 0.0950781007487206, "y_predict": 0, "y": 1}, {"Glucose": 0.25445848326945664, "BMI": 0.8425579963811171, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -0.08919530517323687, "BMI": 1.4114509992360673, "Age": -1.035940379394779, "y_predict": 0, "y": 1}, {"Glucose": 0.5668710182173597, "BMI": -0.825332852898169, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 1.3166611020923273, "BMI": 1.1528632706656352, "Age": 1.2260965808922204, "y_predict": 1, "y": 1}, {"Glucose": -0.6515378680794626, "BMI": 0.9589224742378113, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": -0.589055361089882, "BMI": -0.15300475861504598, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": 0.879283553165263, "BMI": -0.34694555504286995, "Age": 0.7910894731447204, "y_predict": 1, "y": 1}, {"Glucose": 1.0979723276287952, "BMI": -0.9287679443263419, "Age": 1.7481051101892202, "y_predict": 1, "y": 1}, {"Glucose": 2.347622467420408, "BMI": 0.7132641320959011, "Age": 2.09611079638722, "y_predict": 1, "y": 1}, {"Glucose": 0.31694099025903727, "BMI": 0.29952376638320954, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": 0.5043885112277792, "BMI": 1.4373097720931107, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 0.8168010461756823, "BMI": -0.32108678218582687, "Age": 1.4871008455407202, "y_predict": 1, "y": 1}, {"Glucose": 1.472867369566279, "BMI": 0.8037698370955526, "Age": 0.6170866300457205, "y_predict": 1, "y": 1}, {"Glucose": 2.066451185967295, "BMI": 1.5019567042357187, "Age": 1.7481051101892202, "y_predict": 1, "y": 1}, {"Glucose": -0.18291906565760782, "BMI": -0.3986631007569566, "Age": 1.1390951593427203, "y_predict": 1, "y": 1}, {"Glucose": -3.775663217558494, "BMI": 0.907204928523725, "Age": 0.7040880515952205, "y_predict": 0, "y": 1}, {"Glucose": 0.004528455311134083, "BMI": 0.5193233356680771, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 0.6605947787017308, "BMI": 1.553674249949805, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": 1.0979723276287952, "BMI": 2.109637866376233, "Age": -0.07892474235027935, "y_predict": 1, "y": 1}, {"Glucose": 1.4103848625766984, "BMI": 1.7734738192346726, "Age": -0.5139318500977792, "y_predict": 1, "y": 1}, {"Glucose": 0.34818224375382756, "BMI": 0.3124531528117313, "Age": 0.9650923162437204, "y_predict": 1, "y": 1}, {"Glucose": 2.3163812139256175, "BMI": -0.889979785040777, "Age": 1.9221079532882202, "y_predict": 1, "y": 1}, {"Glucose": 1.8165211580089724, "BMI": 0.7520522913814655, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": -0.12043655866802719, "BMI": 0.3253825392402531, "Age": 0.6170866300457205, "y_predict": 1, "y": 1}, {"Glucose": -0.21416031915239814, "BMI": 0.10558296995538555, "Age": 0.7910894731447204, "y_predict": 1, "y": 1}, {"Glucose": 1.4103848625766984, "BMI": -0.7994740800411259, "Age": 1.5741022670902203, "y_predict": 1, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": 0.0021478785272131297, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": -0.3703665866263497, "BMI": 0.4934645628110335, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": -0.18291906565760782, "BMI": -0.10128721290095975, "Age": 0.9650923162437204, "y_predict": 1, "y": 1}, {"Glucose": 1.6915561440298112, "BMI": 0.20901806138355888, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 0.785559792680892, "BMI": -0.5796745107562589, "Age": -0.42693042854827923, "y_predict": 0, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": 0.22194744781208067, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": 2.4101049744099883, "BMI": 1.2045808163797214, "Age": -0.42693042854827923, "y_predict": 1, "y": 1}, {"Glucose": 1.879003664998553, "BMI": 0.2736649935261669, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 0.09825221579550503, "BMI": -0.566745124327737, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": 1.785279904514182, "BMI": 1.0235694063804193, "Age": 0.7040880515952205, "y_predict": 1, "y": 1}, {"Glucose": 2.1289336929568754, "BMI": -0.24351046361469705, "Age": 2.27011363948622, "y_predict": 1, "y": 1}, {"Glucose": -0.49533160060551096, "BMI": 1.4631685449501535, "Age": 1.0520937377932202, "y_predict": 1, "y": 1}, {"Glucose": 1.5353498765558595, "BMI": 1.553674249949805, "Age": 0.8780908946942204, "y_predict": 1, "y": 1}, {"Glucose": 1.4416261160714887, "BMI": -1.1097793543256445, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 1.5795330228068485, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 0.4731472577329888, "BMI": -0.10128721290095975, "Age": -0.9489389578452792, "y_predict": 0, "y": 1}, {"Glucose": -0.05795405167844655, "BMI": -0.631392056470345, "Age": 0.008076679199220628, "y_predict": 0, "y": 1}, {"Glucose": 0.5668710182173597, "BMI": -0.049569667186873084, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 1.285419848597537, "BMI": 2.2777198899470146, "Age": -0.6009332716472792, "y_predict": 1, "y": 1}, {"Glucose": -1.1513979239961076, "BMI": -0.29522800932878374, "Age": 1.1390951593427203, "y_predict": 0, "y": 1}, {"Glucose": 0.12949346929029534, "BMI": 0.23487683424060155, "Age": 1.83510653173872, "y_predict": 1, "y": 1}, {"Glucose": -0.46409034711072067, "BMI": -0.7089683750414748, "Age": -0.33992900699877926, "y_predict": 0, "y": 1}, {"Glucose": 0.2232172297746663, "BMI": -0.19179291790061084, "Age": -0.6879346931967791, "y_predict": 0, "y": 1}, {"Glucose": 2.441346227904779, "BMI": 1.4114509992360673, "Age": -0.9489389578452792, "y_predict": 1, "y": 1}, {"Glucose": 1.6290736370402306, "BMI": -0.29522800932878374, "Age": 0.008076679199220628, "y_predict": 1, "y": 1}, {"Glucose": 0.7543185391861017, "BMI": 0.7649816778099873, "Age": 0.6170866300457205, "y_predict": 1, "y": 1}, {"Glucose": 0.0357697088059244, "BMI": 2.2906492763755364, "Age": -0.16592616389977932, "y_predict": 1, "y": 1}, {"Glucose": 0.8480422996704726, "BMI": 0.7261935185244228, "Age": 1.5741022670902203, "y_predict": 1, "y": 1}, {"Glucose": -0.27664282614197877, "BMI": 0.28659437995468867, "Age": 0.2690809438477206, "y_predict": 0, "y": 1}, {"Glucose": 0.5356297647225695, "BMI": 0.5322527220965989, "Age": 1.4871008455407202, "y_predict": 1, "y": 1}, {"Glucose": -0.6202966145846722, "BMI": 1.7605444328061508, "Age": 0.4430837869467205, "y_predict": 1, "y": 1}, {"Glucose": 0.6293535252069404, "BMI": 1.3468040670934591, "Age": -0.33992900699877926, "y_predict": 1, "y": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Based on the plot, we can say the class 1 in <strong>y_predict</strong> is more likely to be the class 1 in <strong>y</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_train_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">X_train_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_train_scaled_kmeans_balanced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training accuracy 0.7535211267605634
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_scaled_kmeans_balanced</span> <span class="o">=</span> <span class="n">X_test_scaled</span><span class="p">[</span><span class="n">kmeans_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_balanced</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled_kmeans_balanced</span><span class="p">)</span>
<span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_test_scaled_kmeans_balanced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test accuracy 0.7142857142857143
</pre></div>
</div>
</div>
</div>
<p>The new kmeans model looks a little better. We will store the result for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_balanced_result</span> <span class="o">=</span> <span class="n">kmeans_balanced</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="n">kmeans_cols</span><span class="p">])</span>
<span class="n">kmeans_balanced_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">X_test_scaled_kmeans_balanced</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_test_scaled_kmeans_balanced</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-4-kmeans-with-pca">
<h2>Part 4: Kmeans with PCA<a class="headerlink" href="#part-4-kmeans-with-pca" title="Permalink to this headline">#</a></h2>
<p><strong>Extra3</strong>
In this part, I will use PCA to decrease the dimension into 2 and then use kmeans to do clustering. And I will also use the balanced dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled_balanced</span><span class="p">)</span>
<span class="n">X_train_scaled_PCA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_scaled_balanced</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PCA0&quot;</span><span class="p">,</span><span class="s2">&quot;PCA1&quot;</span><span class="p">])</span>
<span class="n">kmeans_PCA</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kmeans_PCA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled_PCA</span><span class="p">)</span>
<span class="n">X_train_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_PCA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled_PCA</span><span class="p">)</span>
<span class="n">X_train_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_train_balanced</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_PCA</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PCA0&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;PCA1&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y:N&quot;</span>
<span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">X_train_scaled_PCA</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PCA0&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;PCA1&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;y_predict:N&quot;</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-8522204b0d6544889efdea8dd829c6e4"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8522204b0d6544889efdea8dd829c6e4") {
      outputDiv = document.getElementById("altair-viz-8522204b0d6544889efdea8dd829c6e4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "hconcat": [{"mark": "circle", "encoding": {"color": {"field": "y", "type": "nominal"}, "x": {"field": "PCA0", "type": "quantitative"}, "y": {"field": "PCA1", "type": "quantitative"}}}, {"mark": "circle", "encoding": {"color": {"field": "y_predict", "type": "nominal"}, "x": {"field": "PCA0", "type": "quantitative"}, "y": {"field": "PCA1", "type": "quantitative"}}}], "data": {"name": "data-b8a3c6250afb9aea34f17d67d7e55eb5"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-b8a3c6250afb9aea34f17d67d7e55eb5": [{"PCA0": -0.7340119884275443, "PCA1": -1.639543885909855, "y_predict": 0, "y": 0}, {"PCA0": 3.502327728247382, "PCA1": -1.1255485788268877, "y_predict": 1, "y": 0}, {"PCA0": 0.7460643518735536, "PCA1": -0.9032780542520616, "y_predict": 1, "y": 0}, {"PCA0": 1.5019493262443608, "PCA1": 0.2587139177765904, "y_predict": 1, "y": 0}, {"PCA0": 1.9291345348104048, "PCA1": -0.8826690383483473, "y_predict": 1, "y": 0}, {"PCA0": 1.0817993448243322, "PCA1": -0.49636293947916466, "y_predict": 1, "y": 0}, {"PCA0": 0.6247426755131553, "PCA1": 1.05435404531213, "y_predict": 1, "y": 0}, {"PCA0": -0.27873576281225554, "PCA1": 1.6262838450380728, "y_predict": 0, "y": 0}, {"PCA0": -2.058708645734619, "PCA1": -0.7506521705825716, "y_predict": 0, "y": 0}, {"PCA0": 1.8413344997591259, "PCA1": -0.04859729961568323, "y_predict": 1, "y": 0}, {"PCA0": -0.6546427393647688, "PCA1": 0.22554145926073121, "y_predict": 0, "y": 0}, {"PCA0": -0.45146958553583577, "PCA1": 1.7007519438864558, "y_predict": 0, "y": 0}, {"PCA0": 0.3296477539769407, "PCA1": -1.7040690192156958, "y_predict": 1, "y": 0}, {"PCA0": 1.6607032665767194, "PCA1": 0.7309772268243311, "y_predict": 1, "y": 0}, {"PCA0": 0.5835150728135425, "PCA1": 2.119855347936508, "y_predict": 1, "y": 0}, {"PCA0": 0.7781133872638742, "PCA1": 0.849554223194804, "y_predict": 1, "y": 0}, {"PCA0": -0.8910642309291438, "PCA1": 1.133908929894437, "y_predict": 0, "y": 0}, {"PCA0": 2.315638806331542, "PCA1": -0.522742265648634, "y_predict": 1, "y": 0}, {"PCA0": -0.13733828487624564, "PCA1": 0.48325224882653683, "y_predict": 0, "y": 0}, {"PCA0": 1.4130294485399195, "PCA1": -1.2199586571775765, "y_predict": 1, "y": 0}, {"PCA0": 0.9646826672959719, "PCA1": 2.977364201203581, "y_predict": 1, "y": 0}, {"PCA0": -0.9379123258327898, "PCA1": 1.7296199139364983, "y_predict": 0, "y": 0}, {"PCA0": 0.43261497496610024, "PCA1": -0.9845449513780377, "y_predict": 1, "y": 0}, {"PCA0": 2.728263989920904, "PCA1": -0.25142844717302715, "y_predict": 1, "y": 0}, {"PCA0": 4.842404773402508, "PCA1": -0.4456416896890997, "y_predict": 1, "y": 0}, {"PCA0": -0.551421713888601, "PCA1": -1.200766722130308, "y_predict": 0, "y": 0}, {"PCA0": 0.7613992871396995, "PCA1": -0.5472642866806768, "y_predict": 1, "y": 0}, {"PCA0": 1.3231683947466295, "PCA1": -1.2093262314919109, "y_predict": 1, "y": 0}, {"PCA0": 1.7934498761002107, "PCA1": 0.3482398646805242, "y_predict": 1, "y": 0}, {"PCA0": 3.94135510331233, "PCA1": -1.0409873225370094, "y_predict": 1, "y": 0}, {"PCA0": -1.751949380642993, "PCA1": -1.4414692199720351, "y_predict": 0, "y": 0}, {"PCA0": -1.9349182517858932, "PCA1": 1.545546456942384, "y_predict": 0, "y": 0}, {"PCA0": 1.1823116808649055, "PCA1": -0.9746817002883454, "y_predict": 1, "y": 0}, {"PCA0": 1.05062974406304, "PCA1": 2.044089966530149, "y_predict": 1, "y": 0}, {"PCA0": 1.3160110883930554, "PCA1": -1.091136952086749, "y_predict": 1, "y": 0}, {"PCA0": 0.8716680291633573, "PCA1": 1.3489475909273758, "y_predict": 1, "y": 0}, {"PCA0": 1.7241655997488137, "PCA1": -0.24581196813904657, "y_predict": 1, "y": 0}, {"PCA0": 1.4527997559732195, "PCA1": 0.5771043025609751, "y_predict": 1, "y": 0}, {"PCA0": 2.383164647401077, "PCA1": 0.1912850870853847, "y_predict": 1, "y": 0}, {"PCA0": -0.6743726728131374, "PCA1": 1.7388905460664845, "y_predict": 0, "y": 0}, {"PCA0": -0.9795270512213516, "PCA1": 3.590341707060625, "y_predict": 0, "y": 0}, {"PCA0": 0.4320888102062167, "PCA1": -1.5548085452448068, "y_predict": 1, "y": 0}, {"PCA0": 2.00650099775032, "PCA1": -0.5887674798473739, "y_predict": 1, "y": 0}, {"PCA0": 0.7280145526761509, "PCA1": 0.4046643247162333, "y_predict": 1, "y": 0}, {"PCA0": 0.3339378655886908, "PCA1": 0.8568655759373217, "y_predict": 1, "y": 0}, {"PCA0": 1.0806347171167148, "PCA1": -0.6047891608656957, "y_predict": 1, "y": 0}, {"PCA0": 1.1725325413979608, "PCA1": -0.07009817370342192, "y_predict": 1, "y": 0}, {"PCA0": 0.9658815273444649, "PCA1": -1.2217708227032762, "y_predict": 1, "y": 0}, {"PCA0": -1.5939194753809272, "PCA1": -0.7317254155066027, "y_predict": 0, "y": 0}, {"PCA0": -0.8572757600963481, "PCA1": 2.801230594215463, "y_predict": 0, "y": 0}, {"PCA0": 0.8247025039894986, "PCA1": -0.8263892585870458, "y_predict": 1, "y": 0}, {"PCA0": -0.218192272693737, "PCA1": -1.32978620206514, "y_predict": 1, "y": 0}, {"PCA0": -0.9756714253952695, "PCA1": -0.4218654582783872, "y_predict": 0, "y": 0}, {"PCA0": -1.5400391541838416, "PCA1": 1.2928954482453021, "y_predict": 0, "y": 0}, {"PCA0": 0.2910137719364008, "PCA1": -0.4683561960900026, "y_predict": 1, "y": 0}, {"PCA0": 1.7268536393213207, "PCA1": -0.13623282606248815, "y_predict": 1, "y": 0}, {"PCA0": 0.33383859077862127, "PCA1": 3.053823408094078, "y_predict": 0, "y": 0}, {"PCA0": -0.14520230225066738, "PCA1": -0.6925929672720982, "y_predict": 1, "y": 0}, {"PCA0": 0.20041363322518796, "PCA1": -1.6409998532882955, "y_predict": 1, "y": 0}, {"PCA0": -0.23921084729886366, "PCA1": -0.059098522673831276, "y_predict": 0, "y": 0}, {"PCA0": 1.2249229692061834, "PCA1": -1.0773404776358992, "y_predict": 1, "y": 0}, {"PCA0": 1.0667177982731146, "PCA1": -1.355655846809491, "y_predict": 1, "y": 0}, {"PCA0": 1.1692745404182292, "PCA1": 0.3808572990601296, "y_predict": 1, "y": 0}, {"PCA0": 1.3391935472998686, "PCA1": -0.9120341033014273, "y_predict": 1, "y": 0}, {"PCA0": 0.4688855225267329, "PCA1": -0.8105615779028013, "y_predict": 1, "y": 0}, {"PCA0": -0.9557990319700439, "PCA1": -1.8459831852726536, "y_predict": 0, "y": 0}, {"PCA0": 0.23573681831402016, "PCA1": -1.1910798326116556, "y_predict": 1, "y": 0}, {"PCA0": 0.7788142857965121, "PCA1": -1.419248540293775, "y_predict": 1, "y": 0}, {"PCA0": 1.2317685892792907, "PCA1": -1.1247138819611566, "y_predict": 1, "y": 0}, {"PCA0": 1.9428368400168847, "PCA1": -0.8161730949741937, "y_predict": 1, "y": 0}, {"PCA0": 1.1118946491409467, "PCA1": -1.1322936727748447, "y_predict": 1, "y": 0}, {"PCA0": -0.9073507901410723, "PCA1": -1.1624326515179686, "y_predict": 0, "y": 0}, {"PCA0": 3.085355741705078, "PCA1": -0.4229113396914791, "y_predict": 1, "y": 0}, {"PCA0": 1.7581140746225274, "PCA1": -0.8131895633363698, "y_predict": 1, "y": 0}, {"PCA0": 0.2900054034472838, "PCA1": 0.1631178298510652, "y_predict": 1, "y": 0}, {"PCA0": -0.8820920305902177, "PCA1": 0.4115568708845318, "y_predict": 0, "y": 0}, {"PCA0": 1.4141194321572892, "PCA1": 0.2885138742699157, "y_predict": 1, "y": 0}, {"PCA0": 1.0275749789156061, "PCA1": -0.5230616046566126, "y_predict": 1, "y": 0}, {"PCA0": 0.9829736824740403, "PCA1": -0.37923439704044437, "y_predict": 1, "y": 0}, {"PCA0": 0.6325185084775045, "PCA1": -1.430589444263957, "y_predict": 1, "y": 0}, {"PCA0": 0.8326762113537302, "PCA1": -0.8278506868751707, "y_predict": 1, "y": 0}, {"PCA0": 0.6072363067691435, "PCA1": 1.8147525008439946, "y_predict": 1, "y": 0}, {"PCA0": 2.0928650516661573, "PCA1": -1.2341253009841167, "y_predict": 1, "y": 0}, {"PCA0": 0.5914634556529509, "PCA1": 0.05328867142349988, "y_predict": 1, "y": 0}, {"PCA0": 2.3196099784970072, "PCA1": 0.4493179911341453, "y_predict": 1, "y": 0}, {"PCA0": -2.1103446064545035, "PCA1": -2.0433636288627266, "y_predict": 0, "y": 0}, {"PCA0": 2.2066762919900773, "PCA1": -1.5334081355068623, "y_predict": 1, "y": 0}, {"PCA0": 1.3434691895639597, "PCA1": -0.7552638604389861, "y_predict": 1, "y": 0}, {"PCA0": 1.08914714995107, "PCA1": -0.5274469561699514, "y_predict": 1, "y": 0}, {"PCA0": -0.05389155896214903, "PCA1": -1.6990771667397149, "y_predict": 1, "y": 0}, {"PCA0": -0.2963873475323926, "PCA1": -1.9480199238362956, "y_predict": 1, "y": 0}, {"PCA0": 2.4515753169419616, "PCA1": -0.11495406820237317, "y_predict": 1, "y": 0}, {"PCA0": 0.37770167771046037, "PCA1": -0.5018238307536943, "y_predict": 1, "y": 0}, {"PCA0": 0.1458567997398385, "PCA1": -1.7505402100452865, "y_predict": 1, "y": 0}, {"PCA0": 1.075705331202512, "PCA1": 0.28654863580113593, "y_predict": 1, "y": 0}, {"PCA0": 1.6190399766032146, "PCA1": 1.023183127646148, "y_predict": 1, "y": 0}, {"PCA0": 0.5382065417636197, "PCA1": -1.4162990448547041, "y_predict": 1, "y": 0}, {"PCA0": -0.45097140550748094, "PCA1": -1.5590842121219273, "y_predict": 1, "y": 0}, {"PCA0": 3.152239920479413, "PCA1": 0.2580777247732923, "y_predict": 1, "y": 0}, {"PCA0": 1.1466173438694658, "PCA1": 1.4867033623614556, "y_predict": 1, "y": 0}, {"PCA0": 1.5669173210884184, "PCA1": -1.2693981481882288, "y_predict": 1, "y": 0}, {"PCA0": -0.3804043305287126, "PCA1": -1.217294486581582, "y_predict": 1, "y": 0}, {"PCA0": -0.9015754001127111, "PCA1": 3.220720984352959, "y_predict": 0, "y": 0}, {"PCA0": -0.35305993464927354, "PCA1": -2.121634881134236, "y_predict": 1, "y": 0}, {"PCA0": -0.0875634201821463, "PCA1": -2.1255803460789666, "y_predict": 1, "y": 0}, {"PCA0": 1.37188741812529, "PCA1": -0.7624242697160447, "y_predict": 1, "y": 0}, {"PCA0": 0.8600192132683327, "PCA1": -1.5147790733281803, "y_predict": 1, "y": 0}, {"PCA0": 0.27590379467868487, "PCA1": 3.21291749440595, "y_predict": 0, "y": 0}, {"PCA0": 1.3562136671347012, "PCA1": -1.061397480134707, "y_predict": 1, "y": 0}, {"PCA0": 0.3739351402220086, "PCA1": 0.07798614740802921, "y_predict": 1, "y": 0}, {"PCA0": 1.2239259623730032, "PCA1": -0.16926132819155748, "y_predict": 1, "y": 0}, {"PCA0": 0.3672012985945236, "PCA1": -0.3947251926849716, "y_predict": 1, "y": 0}, {"PCA0": -1.0297782435458729, "PCA1": 0.057899347943765195, "y_predict": 0, "y": 0}, {"PCA0": 1.8226091152672512, "PCA1": -0.612914621946408, "y_predict": 1, "y": 0}, {"PCA0": -1.0096450922356588, "PCA1": -1.4837836755134075, "y_predict": 0, "y": 0}, {"PCA0": 2.0205547803739448, "PCA1": -0.14360511495325629, "y_predict": 1, "y": 0}, {"PCA0": -1.8276340192371618, "PCA1": -0.1798042797151312, "y_predict": 0, "y": 0}, {"PCA0": 1.7344111726062856, "PCA1": 1.6742870601046667, "y_predict": 1, "y": 0}, {"PCA0": 1.3849489648462736, "PCA1": -0.6997199524439967, "y_predict": 1, "y": 0}, {"PCA0": 1.5427054833637952, "PCA1": -0.39223766395834697, "y_predict": 1, "y": 0}, {"PCA0": 1.1995054172719992, "PCA1": 1.2176606245038324, "y_predict": 1, "y": 0}, {"PCA0": 1.8841325792037293, "PCA1": -0.9489216259090614, "y_predict": 1, "y": 0}, {"PCA0": -1.6874917485501673, "PCA1": -1.8085315631820016, "y_predict": 0, "y": 0}, {"PCA0": 0.4979424361189189, "PCA1": 1.0133236534275492, "y_predict": 1, "y": 0}, {"PCA0": -0.7251776930485153, "PCA1": -0.7490037632331703, "y_predict": 0, "y": 0}, {"PCA0": -0.47892487372151404, "PCA1": -1.0346856650118919, "y_predict": 0, "y": 0}, {"PCA0": -0.7852575183981206, "PCA1": 0.5324388991335602, "y_predict": 0, "y": 0}, {"PCA0": -0.08240282892885449, "PCA1": 1.038932072506581, "y_predict": 0, "y": 0}, {"PCA0": 0.7653601392407412, "PCA1": 1.0604787970268046, "y_predict": 1, "y": 0}, {"PCA0": 0.6170412964511053, "PCA1": 1.1480645068061024, "y_predict": 1, "y": 0}, {"PCA0": -0.12845063246190966, "PCA1": -1.1137701233858337, "y_predict": 1, "y": 0}, {"PCA0": 0.977412347094067, "PCA1": -1.0110485920720262, "y_predict": 1, "y": 0}, {"PCA0": 0.8571500895046547, "PCA1": 0.0016901734623468482, "y_predict": 1, "y": 0}, {"PCA0": 0.5503649167108928, "PCA1": 0.00448959909602778, "y_predict": 1, "y": 0}, {"PCA0": -2.843897196106629, "PCA1": -2.5928220314349626, "y_predict": 0, "y": 0}, {"PCA0": 0.5821092108817438, "PCA1": 0.9978179003021989, "y_predict": 1, "y": 0}, {"PCA0": 1.5048010916409302, "PCA1": -0.9980238419934016, "y_predict": 1, "y": 0}, {"PCA0": 0.10009672455821116, "PCA1": 0.552736275073593, "y_predict": 1, "y": 0}, {"PCA0": 1.5046156951438152, "PCA1": -0.6157070787023433, "y_predict": 1, "y": 0}, {"PCA0": 0.3287734016686486, "PCA1": 2.2767630981949005, "y_predict": 0, "y": 0}, {"PCA0": -0.5363239988287745, "PCA1": -1.2268476703719653, "y_predict": 0, "y": 0}, {"PCA0": 0.5269783642336002, "PCA1": -1.0951921394944335, "y_predict": 1, "y": 0}, {"PCA0": 0.32653290074312497, "PCA1": -1.4433529650369534, "y_predict": 1, "y": 0}, {"PCA0": 0.24512062686058708, "PCA1": -0.9982569232995182, "y_predict": 1, "y": 0}, {"PCA0": 0.40557798589740185, "PCA1": -1.5505300415128376, "y_predict": 1, "y": 0}, {"PCA0": 0.26580007754604323, "PCA1": -0.6689968148391869, "y_predict": 1, "y": 0}, {"PCA0": 1.6428819193902926, "PCA1": -1.167793861608242, "y_predict": 1, "y": 0}, {"PCA0": 1.3861400761364433, "PCA1": -0.41603229266235664, "y_predict": 1, "y": 0}, {"PCA0": 1.6112988924346414, "PCA1": -0.8597954212105241, "y_predict": 1, "y": 0}, {"PCA0": 0.4056044357649067, "PCA1": -1.4475775318940567, "y_predict": 1, "y": 0}, {"PCA0": 0.48911121108950245, "PCA1": -1.8648059192043842, "y_predict": 1, "y": 0}, {"PCA0": 0.9421614980015824, "PCA1": -1.2283859222203548, "y_predict": 1, "y": 0}, {"PCA0": 0.1864829633464066, "PCA1": -0.10099414745755449, "y_predict": 1, "y": 0}, {"PCA0": 1.1508160494375617, "PCA1": -1.1443153535827528, "y_predict": 1, "y": 0}, {"PCA0": 0.5639486445642854, "PCA1": 1.8214191157362873, "y_predict": 1, "y": 0}, {"PCA0": -0.08214332829956635, "PCA1": 2.273991059035853, "y_predict": 0, "y": 0}, {"PCA0": 1.1461033352893222, "PCA1": -0.5787921122253982, "y_predict": 1, "y": 0}, {"PCA0": 1.1689473277056512, "PCA1": -1.2409156707744196, "y_predict": 1, "y": 0}, {"PCA0": -1.4928530148503147, "PCA1": -1.8035071438683727, "y_predict": 0, "y": 0}, {"PCA0": 1.7523366957378737, "PCA1": -0.19354982431731838, "y_predict": 1, "y": 0}, {"PCA0": 1.8165371409253253, "PCA1": 0.16406900659462106, "y_predict": 1, "y": 0}, {"PCA0": 0.4162797200482478, "PCA1": -0.8604033758100156, "y_predict": 1, "y": 0}, {"PCA0": -0.30331758832793476, "PCA1": -0.03397216942913195, "y_predict": 0, "y": 0}, {"PCA0": -0.22498947568503436, "PCA1": 0.35482645339037705, "y_predict": 0, "y": 0}, {"PCA0": 0.9556980054301256, "PCA1": 2.421227476486205, "y_predict": 1, "y": 0}, {"PCA0": 0.24886094809537715, "PCA1": -1.7424666571363538, "y_predict": 1, "y": 0}, {"PCA0": 2.477894854680815, "PCA1": 0.9475107153463213, "y_predict": 1, "y": 0}, {"PCA0": -1.2151063585706399, "PCA1": 1.8644437554647657, "y_predict": 0, "y": 0}, {"PCA0": -1.4089216418288077, "PCA1": -1.7356967080720072, "y_predict": 0, "y": 0}, {"PCA0": 1.4175956746089151, "PCA1": 1.3267687840656126, "y_predict": 1, "y": 0}, {"PCA0": 0.9351029785528834, "PCA1": 0.6597560547185056, "y_predict": 1, "y": 0}, {"PCA0": 0.14835040016160322, "PCA1": 1.945325927888242, "y_predict": 0, "y": 0}, {"PCA0": 2.0216824005629355, "PCA1": -0.5137546597905339, "y_predict": 1, "y": 0}, {"PCA0": 1.2362486690772545, "PCA1": 2.486664498345998, "y_predict": 1, "y": 0}, {"PCA0": 2.720847427669043, "PCA1": -0.5723699173181535, "y_predict": 1, "y": 0}, {"PCA0": 0.6544662220629557, "PCA1": -1.335578716378202, "y_predict": 1, "y": 0}, {"PCA0": -0.6390190486647536, "PCA1": -2.060772636983016, "y_predict": 1, "y": 0}, {"PCA0": -0.3316223575164349, "PCA1": -1.6341253343670599, "y_predict": 1, "y": 0}, {"PCA0": 0.6373129682776614, "PCA1": -1.3585426284434137, "y_predict": 1, "y": 0}, {"PCA0": 1.8660652908345956, "PCA1": 0.40011363635483344, "y_predict": 1, "y": 0}, {"PCA0": 1.3589869906280014, "PCA1": -0.17120846305155799, "y_predict": 1, "y": 0}, {"PCA0": 1.6918652296320857, "PCA1": -1.0548661311611118, "y_predict": 1, "y": 0}, {"PCA0": 0.9607543157676229, "PCA1": -1.4220110645635227, "y_predict": 1, "y": 0}, {"PCA0": 1.4401677375583046, "PCA1": -1.0807560455418042, "y_predict": 1, "y": 0}, {"PCA0": 1.008623575654418, "PCA1": -0.2965884979863942, "y_predict": 1, "y": 0}, {"PCA0": 2.8181751721466064, "PCA1": -1.2959662140317976, "y_predict": 1, "y": 0}, {"PCA0": -0.18337249966475216, "PCA1": -0.8513117584917548, "y_predict": 1, "y": 0}, {"PCA0": 1.266635470100979, "PCA1": -1.1107338468789865, "y_predict": 1, "y": 0}, {"PCA0": -1.2558498956657789, "PCA1": -0.6840857012861884, "y_predict": 0, "y": 0}, {"PCA0": 0.8812686376378321, "PCA1": 0.26643722131718306, "y_predict": 1, "y": 0}, {"PCA0": 2.305409391915245, "PCA1": 0.10070866994769422, "y_predict": 1, "y": 0}, {"PCA0": 0.5009124357458986, "PCA1": -1.3910384181831352, "y_predict": 1, "y": 0}, {"PCA0": 0.951334024278396, "PCA1": 0.6550526013258161, "y_predict": 1, "y": 0}, {"PCA0": 0.7564825500386472, "PCA1": -0.9831853065578474, "y_predict": 1, "y": 0}, {"PCA0": 0.19518308263149023, "PCA1": -1.4165711893095145, "y_predict": 1, "y": 0}, {"PCA0": 0.8835257422512749, "PCA1": -0.1592649412320602, "y_predict": 1, "y": 0}, {"PCA0": 0.6900075215375538, "PCA1": 0.8156594487046551, "y_predict": 1, "y": 0}, {"PCA0": 2.3540324745080006, "PCA1": 0.7107852118205813, "y_predict": 1, "y": 0}, {"PCA0": 1.9217091085757128, "PCA1": 1.4652134120457563, "y_predict": 1, "y": 0}, {"PCA0": 0.41783433453000063, "PCA1": -1.125450908567968, "y_predict": 1, "y": 0}, {"PCA0": 1.015315622866045, "PCA1": -0.5956327518334477, "y_predict": 1, "y": 0}, {"PCA0": 1.3659532249678936, "PCA1": 1.222015431508986, "y_predict": 1, "y": 0}, {"PCA0": 0.48030264957610536, "PCA1": -1.1308795924384138, "y_predict": 1, "y": 0}, {"PCA0": 0.3485311486655739, "PCA1": 3.203452059320804, "y_predict": 0, "y": 0}, {"PCA0": -0.11644653920637585, "PCA1": 1.739040492514468, "y_predict": 0, "y": 0}, {"PCA0": -3.001525504549394, "PCA1": 1.1138501297450103, "y_predict": 0, "y": 0}, {"PCA0": 1.2500355766197169, "PCA1": -0.45816010763666126, "y_predict": 1, "y": 0}, {"PCA0": 0.7814590125571238, "PCA1": -1.0374738034524882, "y_predict": 1, "y": 0}, {"PCA0": -2.7216540823957476, "PCA1": -1.8617864714385821, "y_predict": 0, "y": 0}, {"PCA0": 1.3168623790058749, "PCA1": -1.2008437804715892, "y_predict": 1, "y": 0}, {"PCA0": 0.7215143637649648, "PCA1": -0.42299476573340944, "y_predict": 1, "y": 0}, {"PCA0": 0.5640380458415281, "PCA1": -1.356797897395939, "y_predict": 1, "y": 0}, {"PCA0": 0.03339730630188322, "PCA1": -1.0038682832336836, "y_predict": 1, "y": 0}, {"PCA0": -0.8658243290171125, "PCA1": 1.6188937806158685, "y_predict": 0, "y": 1}, {"PCA0": -2.704556753711298, "PCA1": -0.15075394617703386, "y_predict": 0, "y": 1}, {"PCA0": 2.3116696092522884, "PCA1": -0.4205035667266533, "y_predict": 1, "y": 1}, {"PCA0": -0.9111763091665093, "PCA1": 1.8622081688045287, "y_predict": 0, "y": 1}, {"PCA0": -0.22963342410713836, "PCA1": 0.33058629991281524, "y_predict": 0, "y": 1}, {"PCA0": 0.30764916471658127, "PCA1": 1.1166018588113464, "y_predict": 1, "y": 1}, {"PCA0": 0.34539666808594083, "PCA1": -0.9504414812182939, "y_predict": 1, "y": 1}, {"PCA0": 1.2314120899038348, "PCA1": 0.8267324508006284, "y_predict": 1, "y": 1}, {"PCA0": -0.30521517973153345, "PCA1": 0.5121644714145165, "y_predict": 0, "y": 1}, {"PCA0": 0.6028725788208865, "PCA1": 0.05751034655070857, "y_predict": 1, "y": 1}, {"PCA0": -1.3829567456139658, "PCA1": -1.1111976856294632, "y_predict": 0, "y": 1}, {"PCA0": -1.93527459378075, "PCA1": -1.569934508208423, "y_predict": 0, "y": 1}, {"PCA0": -0.1859143846514554, "PCA1": 3.045677170483493, "y_predict": 0, "y": 1}, {"PCA0": 1.1836374031475083, "PCA1": -1.1255321707839243, "y_predict": 1, "y": 1}, {"PCA0": -0.02836209845706658, "PCA1": 1.1884309857932658, "y_predict": 0, "y": 1}, {"PCA0": 0.19491944453668708, "PCA1": -1.6992825698013962, "y_predict": 1, "y": 1}, {"PCA0": -1.3734435906374216, "PCA1": -0.9856362874096416, "y_predict": 0, "y": 1}, {"PCA0": -0.08025248763995743, "PCA1": 1.0861112752209976, "y_predict": 0, "y": 1}, {"PCA0": -2.605164118045946, "PCA1": 0.11853089892567421, "y_predict": 0, "y": 1}, {"PCA0": -1.5316463560051967, "PCA1": 2.1550795318780733, "y_predict": 0, "y": 1}, {"PCA0": -2.074088053435985, "PCA1": 1.9624920330077564, "y_predict": 0, "y": 1}, {"PCA0": 0.5998613071605166, "PCA1": 1.1486724000048394, "y_predict": 1, "y": 1}, {"PCA0": -0.7697180971882049, "PCA1": -0.7989895752675592, "y_predict": 0, "y": 1}, {"PCA0": 2.8846991778349986, "PCA1": -1.033324382222306, "y_predict": 1, "y": 1}, {"PCA0": -0.6374836836876349, "PCA1": -1.3764289315212523, "y_predict": 0, "y": 1}, {"PCA0": -1.2531218667465853, "PCA1": -2.248749333892001, "y_predict": 0, "y": 1}, {"PCA0": -0.45775765497706344, "PCA1": -1.3841881246652477, "y_predict": 1, "y": 1}, {"PCA0": 1.7700363661413985, "PCA1": -1.3211335371926256, "y_predict": 1, "y": 1}, {"PCA0": 0.49668124414197634, "PCA1": 1.8266083223920113, "y_predict": 1, "y": 1}, {"PCA0": -0.1884071896767979, "PCA1": -0.3259997776034938, "y_predict": 1, "y": 1}, {"PCA0": 0.4230234336133403, "PCA1": 1.932584116177872, "y_predict": 1, "y": 1}, {"PCA0": 1.1622453712755683, "PCA1": 0.8977949944838706, "y_predict": 1, "y": 1}, {"PCA0": -1.4748988151047462, "PCA1": -1.0125849101085913, "y_predict": 0, "y": 1}, {"PCA0": -1.159750160243751, "PCA1": 0.25021945875765533, "y_predict": 0, "y": 1}, {"PCA0": 0.6579345239013852, "PCA1": 2.26114170772125, "y_predict": 1, "y": 1}, {"PCA0": -0.8994396465419697, "PCA1": 0.13440543680616351, "y_predict": 0, "y": 1}, {"PCA0": -1.1439295779902983, "PCA1": -0.36023001452937586, "y_predict": 0, "y": 1}, {"PCA0": -0.5324063766988302, "PCA1": 1.8648207145755176, "y_predict": 0, "y": 1}, {"PCA0": -3.612910297273611, "PCA1": 1.677100964585112, "y_predict": 0, "y": 1}, {"PCA0": -0.008268610418821458, "PCA1": 1.3107368135082746, "y_predict": 0, "y": 1}, {"PCA0": -0.675984820718718, "PCA1": 2.4358999505010646, "y_predict": 0, "y": 1}, {"PCA0": -2.810404534462081, "PCA1": -2.0059014063303433, "y_predict": 0, "y": 1}, {"PCA0": -1.9420481485758063, "PCA1": -1.2028749498452294, "y_predict": 0, "y": 1}, {"PCA0": -1.2576737606741712, "PCA1": 0.35539746375370135, "y_predict": 0, "y": 1}, {"PCA0": 2.3956311043206933, "PCA1": 0.40706535960012546, "y_predict": 1, "y": 1}, {"PCA0": -1.9031294480579133, "PCA1": 1.010613319200215, "y_predict": 0, "y": 1}, {"PCA0": -2.032275860884931, "PCA1": -0.7924810241452405, "y_predict": 0, "y": 1}, {"PCA0": 1.5881734025830205, "PCA1": 3.4343708518324494, "y_predict": 1, "y": 1}, {"PCA0": -1.1884968417956987, "PCA1": 1.979966884250311, "y_predict": 0, "y": 1}, {"PCA0": -0.7091232253655496, "PCA1": 2.2462136389188525, "y_predict": 0, "y": 1}, {"PCA0": -2.1483281389412863, "PCA1": 0.187171803858875, "y_predict": 0, "y": 1}, {"PCA0": 0.7542168915647244, "PCA1": 2.3827784434131427, "y_predict": 1, "y": 1}, {"PCA0": -0.9382988510181297, "PCA1": 0.1888370322682815, "y_predict": 0, "y": 1}, {"PCA0": 0.9226165457656584, "PCA1": -0.010835649409583495, "y_predict": 1, "y": 1}, {"PCA0": 1.1375222864176664, "PCA1": 1.5513609653903762, "y_predict": 1, "y": 1}, {"PCA0": -2.1674368563247515, "PCA1": 0.40720371826325696, "y_predict": 0, "y": 1}, {"PCA0": -0.5669638736733659, "PCA1": 0.02496737995264531, "y_predict": 0, "y": 1}, {"PCA0": -2.2704353049545416, "PCA1": 1.3870062344085952, "y_predict": 0, "y": 1}, {"PCA0": -1.4334394170175317, "PCA1": 2.123274546493947, "y_predict": 0, "y": 1}, {"PCA0": -0.21349728318017472, "PCA1": -2.467877136024378, "y_predict": 1, "y": 1}, {"PCA0": -0.9672101062746271, "PCA1": 1.1462696035593147, "y_predict": 0, "y": 1}, {"PCA0": -1.0742503957637652, "PCA1": 1.0460099362303288, "y_predict": 0, "y": 1}, {"PCA0": -1.2427047649727856, "PCA1": 3.239420593069708, "y_predict": 0, "y": 1}, {"PCA0": 0.7874946875409383, "PCA1": 1.2421380232377461, "y_predict": 1, "y": 1}, {"PCA0": -2.514362849100433, "PCA1": 0.5821278650184266, "y_predict": 0, "y": 1}, {"PCA0": 0.30004158354203136, "PCA1": 0.7510720038841084, "y_predict": 1, "y": 1}, {"PCA0": -0.391475602122426, "PCA1": -0.013721548608482983, "y_predict": 0, "y": 1}, {"PCA0": 1.1764712285869932, "PCA1": -0.24392047240987108, "y_predict": 1, "y": 1}, {"PCA0": -0.9451162632638167, "PCA1": -1.0737904917901724, "y_predict": 0, "y": 1}, {"PCA0": 1.9490280799701736, "PCA1": -0.4963285771829084, "y_predict": 1, "y": 1}, {"PCA0": -1.9811320072373502, "PCA1": -0.7136089971076314, "y_predict": 0, "y": 1}, {"PCA0": 0.0036417813422246516, "PCA1": 0.3434236898637622, "y_predict": 1, "y": 1}, {"PCA0": -0.4200320229823886, "PCA1": -0.09564324399018624, "y_predict": 0, "y": 1}, {"PCA0": -4.2518613753082715, "PCA1": -3.0877080954576863, "y_predict": 0, "y": 1}, {"PCA0": -2.1616910703388323, "PCA1": -0.7632736595421736, "y_predict": 0, "y": 1}, {"PCA0": -0.2526240372093137, "PCA1": 0.881553754058651, "y_predict": 0, "y": 1}, {"PCA0": 1.0975254611094625, "PCA1": 0.21750081840685404, "y_predict": 1, "y": 1}, {"PCA0": 0.937914646339432, "PCA1": 0.5339644340961902, "y_predict": 1, "y": 1}, {"PCA0": 1.5350944213419477, "PCA1": -0.4262365275099383, "y_predict": 1, "y": 1}, {"PCA0": -1.0411623612446468, "PCA1": -0.3372918792951348, "y_predict": 0, "y": 1}, {"PCA0": -1.5640608692415126, "PCA1": 0.9854224739618803, "y_predict": 0, "y": 1}, {"PCA0": 0.7146968047303603, "PCA1": 1.0123639302788905, "y_predict": 1, "y": 1}, {"PCA0": 0.6980564978590528, "PCA1": -0.5266500467610635, "y_predict": 1, "y": 1}, {"PCA0": -0.10635557361899753, "PCA1": -1.7419173071443814, "y_predict": 1, "y": 1}, {"PCA0": -0.6263499248939439, "PCA1": -0.34973900363769755, "y_predict": 0, "y": 1}, {"PCA0": -0.6477085168638484, "PCA1": 0.33440235138777874, "y_predict": 0, "y": 1}, {"PCA0": -0.06968429135757032, "PCA1": -0.9736148039084883, "y_predict": 1, "y": 1}, {"PCA0": 0.15799724343838237, "PCA1": -0.33556525122169933, "y_predict": 1, "y": 1}, {"PCA0": -2.575877973585993, "PCA1": -0.6562112222553481, "y_predict": 0, "y": 1}, {"PCA0": -0.8249881499648537, "PCA1": 1.8350581205872987, "y_predict": 0, "y": 1}, {"PCA0": -0.5083803814620967, "PCA1": 1.3434937022725615, "y_predict": 0, "y": 1}, {"PCA0": 0.24190015431222978, "PCA1": -1.3056226664652815, "y_predict": 1, "y": 1}, {"PCA0": -1.727444945093137, "PCA1": 2.11001120972582, "y_predict": 0, "y": 1}, {"PCA0": -1.321291607213133, "PCA1": 1.9368838683362164, "y_predict": 0, "y": 1}, {"PCA0": -2.001720963107829, "PCA1": 1.1230338415013743, "y_predict": 0, "y": 1}, {"PCA0": -1.1386847416558799, "PCA1": 2.0877051471384225, "y_predict": 0, "y": 1}, {"PCA0": -0.9206777798919723, "PCA1": -0.2531518870460672, "y_predict": 0, "y": 1}, {"PCA0": -1.8236485123849375, "PCA1": -1.8077678197258191, "y_predict": 0, "y": 1}, {"PCA0": -0.3648734592975687, "PCA1": 1.2037342355044391, "y_predict": 0, "y": 1}, {"PCA0": -2.3771362901067508, "PCA1": -1.4531946774972495, "y_predict": 0, "y": 1}, {"PCA0": 0.7809926663558125, "PCA1": -0.20847192952613655, "y_predict": 1, "y": 1}, {"PCA0": 1.2480261623605278, "PCA1": 1.2287714875199853, "y_predict": 1, "y": 1}, {"PCA0": 0.018095176774131173, "PCA1": 2.085719396188025, "y_predict": 0, "y": 1}, {"PCA0": 0.9911323393883179, "PCA1": -0.16472850401427014, "y_predict": 1, "y": 1}, {"PCA0": 0.559431038454054, "PCA1": -1.4870420081251996, "y_predict": 1, "y": 1}, {"PCA0": -0.3643630657467676, "PCA1": 2.4299417120096822, "y_predict": 0, "y": 1}, {"PCA0": -1.9948325156958922, "PCA1": -1.2680441769692727, "y_predict": 0, "y": 1}, {"PCA0": -0.18761265935542962, "PCA1": -1.2323280696930157, "y_predict": 1, "y": 1}, {"PCA0": -0.03218738416233029, "PCA1": -1.1320948077257607, "y_predict": 1, "y": 1}, {"PCA0": -3.2675375851885833, "PCA1": -2.4016553718090767, "y_predict": 0, "y": 1}, {"PCA0": -2.0526519648983714, "PCA1": -2.009426524704285, "y_predict": 0, "y": 1}, {"PCA0": -2.7248729651864245, "PCA1": 0.32922580150141273, "y_predict": 0, "y": 1}, {"PCA0": -0.5902155729046368, "PCA1": -0.11247986399901849, "y_predict": 0, "y": 1}, {"PCA0": -1.8128707609612913, "PCA1": -2.0227733093758973, "y_predict": 0, "y": 1}, {"PCA0": 0.03301822858191607, "PCA1": 0.10157179898072338, "y_predict": 1, "y": 1}, {"PCA0": -0.5253454868535984, "PCA1": 2.357681479272283, "y_predict": 0, "y": 1}, {"PCA0": -0.4366703988145453, "PCA1": -0.8806013266410434, "y_predict": 0, "y": 1}, {"PCA0": -1.6498750843497505, "PCA1": -0.8024023542174314, "y_predict": 0, "y": 1}, {"PCA0": -0.14040793738936783, "PCA1": 2.544850600680589, "y_predict": 0, "y": 1}, {"PCA0": -0.04014018976150666, "PCA1": 2.4071867321726654, "y_predict": 0, "y": 1}, {"PCA0": -0.15830249506588637, "PCA1": -0.1891087508207391, "y_predict": 1, "y": 1}, {"PCA0": -0.11350571258126761, "PCA1": 1.8386250046809036, "y_predict": 0, "y": 1}, {"PCA0": -0.6371705231566832, "PCA1": 1.1615754866157546, "y_predict": 0, "y": 1}, {"PCA0": -1.2452863945603152, "PCA1": -1.089075636943325, "y_predict": 0, "y": 1}, {"PCA0": -4.4137738007019385, "PCA1": -2.7541617392869338, "y_predict": 0, "y": 1}, {"PCA0": -2.269682343970106, "PCA1": 1.130004904301967, "y_predict": 0, "y": 1}, {"PCA0": -2.0555870684949977, "PCA1": 0.28135250503781695, "y_predict": 0, "y": 1}, {"PCA0": -1.821436375149884, "PCA1": -2.1317518516316114, "y_predict": 0, "y": 1}, {"PCA0": -2.325049006274621, "PCA1": 0.8726682838346054, "y_predict": 0, "y": 1}, {"PCA0": -2.619804792256038, "PCA1": 0.17243006467546895, "y_predict": 0, "y": 1}, {"PCA0": -0.9864288490216605, "PCA1": 1.9096040279684, "y_predict": 0, "y": 1}, {"PCA0": 0.4043010729605074, "PCA1": -0.5705510109223135, "y_predict": 1, "y": 1}, {"PCA0": -3.0601275117553643, "PCA1": 1.4579604996617455, "y_predict": 0, "y": 1}, {"PCA0": -0.7006859832601369, "PCA1": 2.370988507118068, "y_predict": 0, "y": 1}, {"PCA0": -3.332393418322905, "PCA1": -0.6268232847520104, "y_predict": 0, "y": 1}, {"PCA0": -0.2374033102811329, "PCA1": 0.584609859780045, "y_predict": 0, "y": 1}, {"PCA0": -0.33837536386006395, "PCA1": -2.0197868050196037, "y_predict": 1, "y": 1}, {"PCA0": -0.9002967734565731, "PCA1": 0.8593510717333785, "y_predict": 0, "y": 1}, {"PCA0": -0.9599412288822584, "PCA1": -1.613718230611974, "y_predict": 0, "y": 1}, {"PCA0": -3.5157562817912305, "PCA1": 0.8405513847360113, "y_predict": 0, "y": 1}, {"PCA0": 0.7920705296316376, "PCA1": 2.174821352317094, "y_predict": 1, "y": 1}, {"PCA0": 1.3564979375491524, "PCA1": -0.4972113378932892, "y_predict": 1, "y": 1}, {"PCA0": -0.846622695771872, "PCA1": -2.3174402916985106, "y_predict": 0, "y": 1}, {"PCA0": 1.7344440194545399, "PCA1": 0.5581192439636822, "y_predict": 1, "y": 1}, {"PCA0": -2.4039226545928245, "PCA1": -1.6661347954317052, "y_predict": 0, "y": 1}, {"PCA0": 0.8029799984824504, "PCA1": 0.46489915619858413, "y_predict": 1, "y": 1}, {"PCA0": 0.6053290543922667, "PCA1": 1.5213115465834335, "y_predict": 1, "y": 1}, {"PCA0": -1.0232990168686809, "PCA1": -0.06871646383477621, "y_predict": 0, "y": 1}, {"PCA0": 0.8087212377933721, "PCA1": 1.1794595494095492, "y_predict": 1, "y": 1}, {"PCA0": 0.13620663515560064, "PCA1": 0.03838395742158802, "y_predict": 1, "y": 1}, {"PCA0": -2.3379832900080246, "PCA1": 0.48509305477403386, "y_predict": 0, "y": 1}, {"PCA0": -1.4880575147193813, "PCA1": 0.5306450619840568, "y_predict": 0, "y": 1}, {"PCA0": -0.06955027207190573, "PCA1": 0.15979372844269885, "y_predict": 1, "y": 1}, {"PCA0": 0.35033047237778353, "PCA1": 0.6781490688304816, "y_predict": 1, "y": 1}, {"PCA0": 0.992256034506817, "PCA1": 1.1454399811811664, "y_predict": 1, "y": 1}, {"PCA0": -1.5949549086673342, "PCA1": 0.07429456047872458, "y_predict": 0, "y": 1}, {"PCA0": 0.49469870691935974, "PCA1": -0.4819882415456033, "y_predict": 1, "y": 1}, {"PCA0": 1.6624367049518918, "PCA1": 0.015457119283429936, "y_predict": 1, "y": 1}, {"PCA0": -3.038006388097058, "PCA1": 2.2048103278440294, "y_predict": 0, "y": 1}, {"PCA0": -1.6625009510941784, "PCA1": 0.08960215489446634, "y_predict": 0, "y": 1}, {"PCA0": 1.1387109725384674, "PCA1": 1.3816081823279642, "y_predict": 1, "y": 1}, {"PCA0": -0.412472782549462, "PCA1": -0.21845129362630655, "y_predict": 0, "y": 1}, {"PCA0": 0.011863951019790934, "PCA1": 3.1169032338787668, "y_predict": 0, "y": 1}, {"PCA0": -3.1792538905179883, "PCA1": 1.3920012617486388, "y_predict": 0, "y": 1}, {"PCA0": 0.4126768702268616, "PCA1": -1.5074712488894553, "y_predict": 1, "y": 1}, {"PCA0": -2.047077317861259, "PCA1": -2.5269016286253327, "y_predict": 0, "y": 1}, {"PCA0": 0.3003463714196913, "PCA1": 2.2836827444688192, "y_predict": 0, "y": 1}, {"PCA0": -3.2425135818152593, "PCA1": -0.16600224773582475, "y_predict": 0, "y": 1}, {"PCA0": -3.0941813667891216, "PCA1": 0.5615245453886268, "y_predict": 0, "y": 1}, {"PCA0": 0.9838345085013828, "PCA1": 1.4514993838241288, "y_predict": 1, "y": 1}, {"PCA0": 0.7961193092520773, "PCA1": -0.3421760893402835, "y_predict": 1, "y": 1}, {"PCA0": 1.5796737079285528, "PCA1": 0.0017223956280635645, "y_predict": 1, "y": 1}, {"PCA0": -0.1198896746071299, "PCA1": 0.07050732253588507, "y_predict": 1, "y": 1}, {"PCA0": -0.24106282126251155, "PCA1": 0.6243296139711193, "y_predict": 0, "y": 1}, {"PCA0": -0.3087501849200987, "PCA1": 0.5953093253973718, "y_predict": 0, "y": 1}, {"PCA0": 0.40803756975957434, "PCA1": 1.2097795289577677, "y_predict": 1, "y": 1}, {"PCA0": -1.5782728017942194, "PCA1": 1.7010278036800996, "y_predict": 0, "y": 1}, {"PCA0": -0.8743266324739413, "PCA1": -1.9366226506563011, "y_predict": 0, "y": 1}, {"PCA0": -0.4944347504162937, "PCA1": -0.2858523667080993, "y_predict": 0, "y": 1}, {"PCA0": 0.8879761122958171, "PCA1": 1.6790012828095102, "y_predict": 1, "y": 1}, {"PCA0": -1.0913160994696307, "PCA1": 1.14250590306229, "y_predict": 0, "y": 1}, {"PCA0": -1.3992790083103857, "PCA1": -1.0724675355698272, "y_predict": 0, "y": 1}, {"PCA0": -0.42206181075480426, "PCA1": -1.121107620481842, "y_predict": 1, "y": 1}, {"PCA0": 0.8023537820571915, "PCA1": 1.5329277982557004, "y_predict": 1, "y": 1}, {"PCA0": -1.0896472686872702, "PCA1": 2.127613348692094, "y_predict": 0, "y": 1}, {"PCA0": 2.456551206152791, "PCA1": -0.32626503898841497, "y_predict": 1, "y": 1}, {"PCA0": -0.9536122413446836, "PCA1": -1.5687929060927346, "y_predict": 0, "y": 1}, {"PCA0": -2.0874690677784518, "PCA1": -1.6564808177878931, "y_predict": 0, "y": 1}, {"PCA0": -1.1731383607618222, "PCA1": -0.5704033871596258, "y_predict": 0, "y": 1}, {"PCA0": 1.1559591467338368, "PCA1": 0.9895286431649771, "y_predict": 1, "y": 1}, {"PCA0": -0.7377485700654032, "PCA1": 1.8982657685164326, "y_predict": 0, "y": 1}, {"PCA0": -3.8258740963753888, "PCA1": -0.8943475217413482, "y_predict": 0, "y": 1}, {"PCA0": -1.1744235548839745, "PCA1": 1.2038734888219245, "y_predict": 0, "y": 1}, {"PCA0": -1.7150974509853907, "PCA1": 1.317396265903439, "y_predict": 0, "y": 1}, {"PCA0": -0.10505794635052261, "PCA1": -0.21562038896634425, "y_predict": 1, "y": 1}, {"PCA0": 1.3799379690766789, "PCA1": -1.0026646682565468, "y_predict": 1, "y": 1}, {"PCA0": 0.469637909466422, "PCA1": -0.10552937580457636, "y_predict": 1, "y": 1}, {"PCA0": -0.449355311697948, "PCA1": -0.43271682365722736, "y_predict": 0, "y": 1}, {"PCA0": -0.7839743945256354, "PCA1": -0.5996918148674156, "y_predict": 0, "y": 1}, {"PCA0": -1.0912330852260959, "PCA1": -1.3358425024012468, "y_predict": 0, "y": 1}, {"PCA0": 0.11098392148987872, "PCA1": 1.9397012677377161, "y_predict": 0, "y": 1}, {"PCA0": 0.42726351113611705, "PCA1": 2.305237508480082, "y_predict": 1, "y": 1}, {"PCA0": 1.0271841056242046, "PCA1": 0.4112348653284626, "y_predict": 1, "y": 1}, {"PCA0": -0.5016424613959152, "PCA1": -1.6922065614090016, "y_predict": 1, "y": 1}, {"PCA0": -2.2586667429660325, "PCA1": -1.7181498864183657, "y_predict": 0, "y": 1}, {"PCA0": -0.5768148059584672, "PCA1": 0.22424401647924572, "y_predict": 0, "y": 1}, {"PCA0": -2.1589650419078645, "PCA1": 0.4396422638905551, "y_predict": 0, "y": 1}, {"PCA0": -2.127217850359532, "PCA1": -1.8271755742295075, "y_predict": 0, "y": 1}, {"PCA0": -3.2914317847316243, "PCA1": 0.7660584488779655, "y_predict": 0, "y": 1}, {"PCA0": -0.9453381270020371, "PCA1": 0.6023867824393719, "y_predict": 0, "y": 1}, {"PCA0": -1.6562056637231648, "PCA1": 1.7534474098312682, "y_predict": 0, "y": 1}, {"PCA0": -1.7061849629655061, "PCA1": 0.5793853452760177, "y_predict": 0, "y": 1}, {"PCA0": 1.9048739806798667, "PCA1": -0.9039818711349495, "y_predict": 1, "y": 1}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Based on the plot, we can say the class 1 in <strong>y_predict</strong> is more likely to be the class 0 in <strong>y</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_train_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X_train_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_train_scaled_PCA</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training accuracy 0.7065727699530516
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_scaled_PCA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PCA0&quot;</span><span class="p">,</span><span class="s2">&quot;PCA1&quot;</span><span class="p">])</span>

<span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans_PCA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled_PCA</span><span class="p">)</span>
<span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test accuracy&quot;</span><span class="p">,</span>
<span class="p">(</span><span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_test_scaled_PCA</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test accuracy 0.6493506493506493
</pre></div>
</div>
</div>
</div>
<p>PCA is not a good strategy in this task. However, we will still store the result for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PCA_result</span> <span class="o">=</span> <span class="n">kmeans_PCA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled_PCA</span><span class="p">[[</span><span class="s2">&quot;PCA0&quot;</span><span class="p">,</span><span class="s2">&quot;PCA1&quot;</span><span class="p">]])</span>
<span class="n">PCA_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">X_test_scaled_PCA</span><span class="p">[</span><span class="s2">&quot;y_predict&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">X_test_scaled_PCA</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-5-logistic-regression">
<h2>Part 5: Logistic Regression<a class="headerlink" href="#part-5-logistic-regression" title="Permalink to this headline">#</a></h2>
<p><strong>Extra 4</strong>
In this part, we will use logistic regression to predict.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_LR</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_LR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/shared-libs/python3.10/py/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:444: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(random_state=42)</pre></div></div></div></div></div></div></div>
</div>
<p>Based on the error message, we need to increase the max_iter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_LR</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_LR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression(max_iter=500, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(max_iter=500, random_state=42)</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Score: &quot;</span><span class="p">,</span> <span class="n">clf_LR</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Score: &quot;</span><span class="p">,</span> <span class="n">clf_LR</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Score:  0.7703583061889251
Test Score:  0.7467532467532467
</pre></div>
</div>
</div>
</div>
<p>Logistic regression is not overfitting the data. So we will store the result for future use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LR_result</span> <span class="o">=</span> <span class="n">clf_LR</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">LR_acc</span> <span class="o">=</span> <span class="n">clf_LR</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What’s more, we can plot the coefficient for each feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;feature&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="s2">&quot;coef&quot;</span><span class="p">:</span> <span class="n">clf_LR</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;coef&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;coef&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-54e30552c11e4e4d9d741559b6b3d38e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-54e30552c11e4e4d9d741559b6b3d38e") {
      outputDiv = document.getElementById("altair-viz-54e30552c11e4e4d9d741559b6b3d38e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-ec2a0949927148cb43e5c2e604c15084"}, "mark": "bar", "encoding": {"tooltip": [{"field": "feature", "type": "nominal"}, {"field": "coef", "type": "quantitative"}], "x": {"field": "coef", "type": "quantitative"}, "y": {"field": "feature", "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-ec2a0949927148cb43e5c2e604c15084": [{"feature": "Pregnancies", "coef": 0.06434540897882662}, {"feature": "Glucose", "coef": 0.034098233524401195}, {"feature": "BloodPressure", "coef": -0.013879696036828674}, {"feature": "SkinThickness", "coef": 0.003289663738166474}, {"feature": "Insulin", "coef": -0.001804109906606706}, {"feature": "BMI", "coef": 0.10262337075562843}, {"feature": "DiabetesPedigreeFunction", "coef": 0.6269993701729308}, {"feature": "Age", "coef": 0.037089972881679284}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Based on the figure, it seems DiabetesPedigreeFunction is the most important feature, which doesn’t match the conclusion from Random Forest and Decision Tree. The reason is that the dataset we use to train Logistic Regression is unscaled data. The range will effect the coefficient. To view the importance of each feature, we should use scaled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf_LR_scaled</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clf_LR_scaled</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training Score: &quot;</span><span class="p">,</span> <span class="n">clf_LR_scaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Score: &quot;</span><span class="p">,</span> <span class="n">clf_LR_scaled</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;feature&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="s2">&quot;coef&quot;</span><span class="p">:</span> <span class="n">clf_LR_scaled</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;coef&quot;</span><span class="p">,</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">,</span><span class="s2">&quot;coef&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Score:  0.7703583061889251
Test Score:  0.7532467532467533
</pre></div>
</div>
<div class="output text_html">
<div id="altair-viz-2890fb760084485e8a1dae2b4d8e3b08"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2890fb760084485e8a1dae2b4d8e3b08") {
      outputDiv = document.getElementById("altair-viz-2890fb760084485e8a1dae2b4d8e3b08");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-7a4fef014aaff73d0972164fad5c515b"}, "mark": "bar", "encoding": {"tooltip": [{"field": "feature", "type": "nominal"}, {"field": "coef", "type": "quantitative"}], "x": {"field": "coef", "type": "quantitative"}, "y": {"field": "feature", "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-7a4fef014aaff73d0972164fad5c515b": [{"feature": "Pregnancies", "coef": 0.21255832656458146}, {"feature": "Glucose", "coef": 1.0711323063584446}, {"feature": "BloodPressure", "coef": -0.2478415409014392}, {"feature": "SkinThickness", "coef": 0.04569683324571525}, {"feature": "Insulin", "coef": -0.20082660350303605}, {"feature": "BMI", "coef": 0.7781515135997503}, {"feature": "DiabetesPedigreeFunction", "coef": 0.23060672851451663}, {"feature": "Age", "coef": 0.4210017519121533}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>Now it’s clear that Glucose, BMI, and Age are the top 3 important features.</p>
</section>
<section id="part-6-neural-network">
<h2>Part 6: Neural Network<a class="headerlink" href="#part-6-neural-network" title="Permalink to this headline">#</a></h2>
<p><strong>Extra 5</strong>
Nowadays, neural network, or deep learning, is a common strategy to do prediction. In this part, I will use pytorch to build a very simple fully connected neural network to predict.</p>
<p>The following code has no reference since I’m very familiar with Pytorch.
This neural network contains 5 linear layers, the first four activation function is ReLU, and the last one is sigmoid. I would like to use the output of the network, a length 2 tensor, to represent the probability that the input is belong to each class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">simple_net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">simple_net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">linear1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear2</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear3</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear4</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear5</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<p>Since our data is stored as a dataframe, we need to write our own dataset class. The code is copied from <a class="reference external" href="https://androidkt.com/load-pandas-dataframe-using-dataset-and-dataloader-in-pytorch/">https://androidkt.com/load-pandas-dataframe-using-dataset-and-dataloader-in-pytorch/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
 
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfX</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
 
    <span class="n">x</span><span class="o">=</span><span class="n">dfX</span><span class="o">.</span><span class="n">values</span>
 
    <span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
 
  <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">)</span>
   
  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">idx</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_train</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">y_train</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the output of the neural network is a length 2 tensor, so we will use OneHotEncoder to encode each class into a length 2 array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
<span class="n">y_train_onehot</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">y_test_onehot</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now it’s time to train the neural network. Note that Deepnote has no GPU available for Education plan, so I use cpu to train the network. The loss I use is BCELoss (Binary Cross Entropy between the target and the input probabilities.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">epoch</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train_onehot</span><span class="p">)</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">simple_net</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
<span class="n">train_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">):</span>
        <span class="n">_y_predicted</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">_y_predicted</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">/=</span> <span class="n">batch_size</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">test_predicted</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
    <span class="n">test_loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">test_predicted</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_test_onehot</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>

    <span class="n">train_loss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_loss</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">test_loss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test_onehot</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_loss_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_loss_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span><span class="s1">&#39;Test&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/YifengXiong_113_0.png" src="../../_images/YifengXiong_113_0.png" />
</div>
</div>
<p>Based on the figure, epoch 130 is a good stop point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train_onehot</span><span class="p">)</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">simple_net</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCELoss</span><span class="p">()</span>
<span class="n">train_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">130</span><span class="p">):</span>
    <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">):</span>
        <span class="n">_y_predicted</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">_y_predicted</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">/=</span> <span class="n">batch_size</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">test_predicted</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
    <span class="n">test_loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">test_predicted</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_test_onehot</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>

    <span class="n">train_loss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_loss</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">test_loss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test_onehot</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_loss_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_loss_list</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span><span class="s1">&#39;Test&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">NN_result</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>

<span class="n">NN_result</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">NN_result</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">NN_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">NN_result</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">NN_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test accuracy: &quot;</span><span class="p">,</span> <span class="n">NN_acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/YifengXiong_115_0.png" src="../../_images/YifengXiong_115_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test accuracy:  0.7402597402597403
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-7-ensemble-model">
<h2>Part 7: Ensemble Model<a class="headerlink" href="#part-7-ensemble-model" title="Permalink to this headline">#</a></h2>
<p><strong>Extra 6</strong>
In this part, I will ensemble all models I create before, give them weights based on the accuracy. Then I will calculate the result by multiply the weights to their prediction. If the final score is greater than 0.5, then we believe the prediction is 1. This idea comes from CS 178.</p>
<p>The following is the accuracy for each model. We normalize the array to get the weight for each model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DT_acc</span><span class="p">,</span> <span class="n">LR_acc</span><span class="p">,</span> <span class="n">RF_acc</span><span class="p">,</span> <span class="n">kmeans_balanced_acc</span><span class="p">,</span> <span class="n">PCA_acc</span><span class="p">,</span> <span class="n">NN_acc</span><span class="p">])</span>
<span class="n">acc_array</span> <span class="o">=</span> <span class="n">acc_array</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">acc_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following is the predict result for each model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">DT_result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">LR_result</span><span class="p">,</span> <span class="n">RF_result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">kmeans_balanced_result</span><span class="p">,</span> <span class="n">PCA_result</span><span class="p">,</span> <span class="n">NN_result</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The ensemble result is using each model’s weight times the result and then sum up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">acc_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">result_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The last thing we should do is compare the result with a threshold we set: 0.5. If score is larger than 0.5, then we believe it’s class 1, otherwise, it’s class 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble_result</span> <span class="o">=</span> <span class="p">(</span><span class="n">ensemble_result</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is the final accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ensemble_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">ensemble_result</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">ensemble_acc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7987012987012987
</pre></div>
</div>
</div>
</div>
<p>We put all model’s accuracy together and make a barchart to have a clear view of the performance of each model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_acc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Model&quot;</span><span class="p">:[</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span><span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span><span class="s2">&quot;Kmeans&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Kmeans with PCA&quot;</span><span class="p">,</span><span class="s2">&quot;Logistic Regression&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Neural Network&quot;</span><span class="p">,</span><span class="s2">&quot;Ensemble&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;Accuracy&quot;</span><span class="p">:[</span><span class="n">DT_acc</span><span class="p">,</span> <span class="n">RF_acc</span><span class="p">,</span><span class="n">kmeans_balanced_acc</span><span class="p">,</span><span class="n">PCA_acc</span><span class="p">,</span><span class="n">LR_acc</span><span class="p">,</span><span class="n">NN_acc</span><span class="p">,</span><span class="n">ensemble_acc</span><span class="p">]})</span>

<span class="n">sel</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_single</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">],</span> <span class="n">bind</span><span class="o">=</span><span class="s2">&quot;legend&quot;</span><span class="p">)</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df_acc</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)),</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)),</span>
    <span class="n">tooltip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-708b5f2ad72f4b799bffb0b20f9c8bb3"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-708b5f2ad72f4b799bffb0b20f9c8bb3") {
      outputDiv = document.getElementById("altair-viz-708b5f2ad72f4b799bffb0b20f9c8bb3");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.17.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "4.17.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "data": {"name": "data-f0d0829f5ad3f597f8e53f7567a5d3b7"}, "mark": "bar", "encoding": {"color": {"condition": {"field": "Model", "type": "nominal", "selection": "selector003"}, "value": "lightgrey"}, "opacity": {"condition": {"value": 1, "selection": "selector003"}, "value": 0.2}, "tooltip": [{"field": "Model", "type": "nominal"}, {"field": "Accuracy", "type": "quantitative"}], "x": {"field": "Model", "sort": "y", "type": "nominal"}, "y": {"field": "Accuracy", "scale": {"domain": [0.5, 0.8]}, "type": "quantitative"}}, "selection": {"selector003": {"type": "single", "fields": ["Model"], "bind": "legend"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-f0d0829f5ad3f597f8e53f7567a5d3b7": [{"Model": "Decision Tree", "Accuracy": 0.7727272727272727}, {"Model": "Random Forest", "Accuracy": 0.7857142857142857}, {"Model": "Kmeans", "Accuracy": 0.7142857142857143}, {"Model": "Kmeans with PCA", "Accuracy": 0.6493506493506493}, {"Model": "Logistic Regression", "Accuracy": 0.7467532467532467}, {"Model": "Neural Network", "Accuracy": 0.7402597402597403}, {"Model": "Ensemble", "Accuracy": 0.7987012987012987}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>In this project, we build six models to predict positive of diabetes or not. The top 3 important feature to do prediction is Glucose, BMI, and Age. Five models get accuracy over 70%, and Decision Tree and Random Forest get over 75%. We also ensemble these models and get 79.87% accuracy, which is better than any single model.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>Your code above should include references.  Here is some additional space for references.</p>
<ul class="simple">
<li><p>What is the source of your dataset(s)?</p></li>
</ul>
<p>The dataset is from Kaggle: <a class="reference external" href="https://www.kaggle.com/datasets/mathchi/diabetes-data-set">https://www.kaggle.com/datasets/mathchi/diabetes-data-set</a></p>
<ul class="simple">
<li><p>List any other references that you found helpful.</p></li>
</ul>
<p><a class="reference external" href="https://christopherdavisuci.github.io/UCI-Math-10-F22/intro.html">Math 10 Notes</a>
Hands-on Machine Learning with Scikit-Learn, Keras &amp; TensorFlow, by Aurelien Geron
<a class="reference external" href="https://androidkt.com/load-pandas-dataframe-using-dataset-and-dataloader-in-pytorch/">Load Pandas Dataframe using Dataset and DataLoader in PyTorch</a></p>
</section>
<section id="submission">
<h2>Submission<a class="headerlink" href="#submission" title="Permalink to this headline">#</a></h2>
<p>Using the Share button at the top right, <strong>enable Comment privileges</strong> for anyone with a link to the project. Then submit that link on Canvas.</p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=e4ec2d9b-0a4f-47c6-a480-b7b5a104e368' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Proj/StudentProjects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="HaoyangWang.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The analysis of relations between the total covid-affected population and other datas</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="KevinXu.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Salary Classification By Using Decision Tree</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Christopher Davis<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>